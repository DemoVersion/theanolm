/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-23 22:16:55,467 train: TRAINING OPTIONS
2016-11-23 22:16:55,467 train: sequence_length: 25
2016-11-23 22:16:55,468 train: max_epochs: 15
2016-11-23 22:16:55,468 train: batch_size: 24
2016-11-23 22:16:55,468 train: max_annealing_count: 0
2016-11-23 22:16:55,468 train: min_epochs: 1
2016-11-23 22:16:55,468 train: validation_frequency: 1
2016-11-23 22:16:55,468 train: patience: 0
2016-11-23 22:16:55,468 train: stopping_criterion: no-improvement
2016-11-23 22:16:55,468 train: OPTIMIZATION OPTIONS
2016-11-23 22:16:55,468 train: weights: [ 1.]
2016-11-23 22:16:55,469 train: epsilon: 1e-06
2016-11-23 22:16:55,469 train: method: sgd
2016-11-23 22:16:55,469 train: learning_rate: 10.0
2016-11-23 22:16:55,469 train: num_noise_samples: 100
2016-11-23 22:16:55,469 train: momentum: 0.9
2016-11-23 22:16:55,469 train: ignore_unk: False
2016-11-23 22:16:55,469 train: unk_penalty: None
2016-11-23 22:16:55,469 train: cost_function: nce-shared
2016-11-23 22:16:55,469 train: max_gradient_norm: 5.0
2016-11-23 22:16:55,469 train: sqr_gradient_decay_rate: 0.999
2016-11-23 22:16:55,469 train: gradient_decay_rate: 0.9
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-23 22:16:56,635 __init__: One epoch of training data contains 2371 mini-batch updates.
2016-11-23 22:16:56,635 __init__: Class unigram probabilities are in the range [0.00000103, 0.05232915].
2016-11-23 22:16:56,635 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-23 22:16:56,659 _reset: Generating a random order of input lines.
Building neural network.
2016-11-23 22:16:56,666 __init__: Creating layers.
2016-11-23 22:16:56,666 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-23 22:16:56,666 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-23 22:16:56,704 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-23 22:16:56,822 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-23 22:16:56,943 __init__: Initializing parameters.
2016-11-23 22:16:56,943 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-23 22:16:56,943 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-23 22:16:56,943 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-23 22:16:56,943 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-23 22:16:56,943 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-23 22:16:56,943 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-23 22:16:56,943 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2016-11-23 22:17:22,137 _log_update: [200] (8.4 %) of epoch 1 -- lr = 1e+01, cost = 10.88, duration = 6.5 ms
2016-11-23 22:17:35,416 _log_update: [400] (16.9 %) of epoch 1 -- lr = 1e+01, cost = 6.64, duration = 6.5 ms
2016-11-23 22:17:48,683 _log_update: [600] (25.3 %) of epoch 1 -- lr = 1e+01, cost = 5.90, duration = 6.6 ms
2016-11-23 22:18:01,974 _log_update: [800] (33.7 %) of epoch 1 -- lr = 1e+01, cost = 5.23, duration = 6.6 ms
2016-11-23 22:18:15,256 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 1e+01, cost = 4.69, duration = 6.6 ms
2016-11-23 22:18:28,534 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 1e+01, cost = 4.62, duration = 6.6 ms
2016-11-23 22:18:41,834 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 1e+01, cost = 4.93, duration = 6.8 ms
2016-11-23 22:18:55,114 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 1e+01, cost = 4.81, duration = 6.6 ms
2016-11-23 22:19:08,384 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 1e+01, cost = 4.54, duration = 6.6 ms
2016-11-23 22:19:21,652 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 1e+01, cost = 4.56, duration = 6.6 ms
2016-11-23 22:19:34,905 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 1e+01, cost = 4.28, duration = 6.6 ms
2016-11-23 22:19:52,764 _validate: [2365] First validation sample, perplexity 317.13.
2016-11-23 22:20:13,749 _validate: [2368] Center of validation, perplexity 335.96.
2016-11-23 22:20:34,861 _validate: [2371] Last validation sample, perplexity 292.77.
2016-11-23 22:20:34,888 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-23 22:20:34,888 _log_validation: [2371] Validation set cost history: [317.1]
2016-11-23 22:20:34,889 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 3.4 minutes. Best validation perplexity 317.13.
2016-11-23 22:20:36,817 _log_update: [29] (1.2 %) of epoch 2 -- lr = 1e+01, cost = 4.24, duration = 6.6 ms
2016-11-23 22:20:50,056 _log_update: [229] (9.7 %) of epoch 2 -- lr = 1e+01, cost = 4.53, duration = 6.6 ms
2016-11-23 22:21:03,316 _log_update: [429] (18.1 %) of epoch 2 -- lr = 1e+01, cost = 4.52, duration = 6.6 ms
2016-11-23 22:21:16,564 _log_update: [629] (26.5 %) of epoch 2 -- lr = 1e+01, cost = 4.25, duration = 6.5 ms
2016-11-23 22:21:29,816 _log_update: [829] (35.0 %) of epoch 2 -- lr = 1e+01, cost = 4.41, duration = 6.6 ms
2016-11-23 22:21:43,070 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 1e+01, cost = 4.44, duration = 6.6 ms
2016-11-23 22:21:56,319 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 1e+01, cost = 4.65, duration = 6.6 ms
2016-11-23 22:22:09,563 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 1e+01, cost = 4.10, duration = 6.7 ms
2016-11-23 22:22:22,800 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 1e+01, cost = 4.59, duration = 6.5 ms
2016-11-23 22:22:36,041 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 1e+01, cost = 4.13, duration = 6.5 ms
2016-11-23 22:22:49,278 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 1e+01, cost = 4.12, duration = 6.6 ms
2016-11-23 22:23:02,526 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 1e+01, cost = 3.93, duration = 6.6 ms
2016-11-23 22:23:18,457 _validate: [2365] First validation sample, perplexity 219.46.
2016-11-23 22:23:39,440 _validate: [2368] Center of validation, perplexity 241.20.
2016-11-23 22:24:00,424 _validate: [2371] Last validation sample, perplexity 226.09.
2016-11-23 22:24:00,441 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-23 22:24:00,442 _log_validation: [2371] Validation set cost history: 317.1 [231.1]
2016-11-23 22:24:00,443 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 3.4 minutes. Best validation perplexity 231.12.
2016-11-23 22:24:04,294 _log_update: [58] (2.4 %) of epoch 3 -- lr = 1e+01, cost = 4.05, duration = 6.6 ms
2016-11-23 22:24:17,536 _log_update: [258] (10.9 %) of epoch 3 -- lr = 1e+01, cost = 3.84, duration = 6.6 ms
2016-11-23 22:24:30,776 _log_update: [458] (19.3 %) of epoch 3 -- lr = 1e+01, cost = 3.87, duration = 6.6 ms
2016-11-23 22:24:44,024 _log_update: [658] (27.8 %) of epoch 3 -- lr = 1e+01, cost = 3.97, duration = 6.6 ms
2016-11-23 22:24:57,270 _log_update: [858] (36.2 %) of epoch 3 -- lr = 1e+01, cost = 3.76, duration = 6.6 ms
2016-11-23 22:25:10,525 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 1e+01, cost = 4.06, duration = 6.5 ms
2016-11-23 22:25:23,771 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 1e+01, cost = 3.78, duration = 6.6 ms
2016-11-23 22:25:37,020 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 1e+01, cost = 3.74, duration = 6.5 ms
2016-11-23 22:25:50,275 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 1e+01, cost = 4.14, duration = 6.6 ms
2016-11-23 22:26:03,573 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 1e+01, cost = 3.92, duration = 6.6 ms
