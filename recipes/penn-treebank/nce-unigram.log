/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-21 03:43:17,968 train: TRAINING OPTIONS
2016-11-21 03:43:17,968 train: max_annealing_count: 0
2016-11-21 03:43:17,968 train: max_epochs: 20
2016-11-21 03:43:17,968 train: stopping_criterion: no-improvement
2016-11-21 03:43:17,969 train: strategy: local-mean
2016-11-21 03:43:17,969 train: validation_frequency: 1
2016-11-21 03:43:17,969 train: sequence_length: 100
2016-11-21 03:43:17,969 train: patience: 0
2016-11-21 03:43:17,969 train: min_epochs: 1
2016-11-21 03:43:17,969 train: batch_size: 16
2016-11-21 03:43:17,969 train: OPTIMIZATION OPTIONS
2016-11-21 03:43:17,969 train: gradient_decay_rate: 0.9
2016-11-21 03:43:17,969 train: epsilon: 1e-06
2016-11-21 03:43:17,969 train: cost_function: nce
2016-11-21 03:43:17,969 train: method: sgd
2016-11-21 03:43:17,969 train: num_noise_samples: 25
2016-11-21 03:43:17,969 train: momentum: 0.9
2016-11-21 03:43:17,969 train: max_gradient_norm: 5.0
2016-11-21 03:43:17,969 train: unk_penalty: None
2016-11-21 03:43:17,969 train: sqr_gradient_decay_rate: 0.999
2016-11-21 03:43:17,969 train: ignore_unk: False
2016-11-21 03:43:17,970 train: weights: [ 1.]
2016-11-21 03:43:17,970 train: learning_rate: 20.0
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-21 03:43:19,064 __init__: One epoch of training data contains 2630 mini-batch updates.
2016-11-21 03:43:19,064 __init__: Class unigram probabilities are in the range [0.000001, 0.052251].
2016-11-21 03:43:19,065 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-21 03:43:19,128 _reset: Generating a random order of input lines.
Building neural network.
2016-11-21 03:43:19,135 __init__: Creating layers.
2016-11-21 03:43:19,135 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-21 03:43:19,135 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-21 03:43:19,174 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-21 03:43:19,372 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-21 03:43:19,492 __init__: Initializing parameters.
2016-11-21 03:43:19,492 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-21 03:43:19,493 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-21 03:43:19,493 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-21 03:43:19,493 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-21 03:43:19,493 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-21 03:43:19,493 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-21 03:43:19,493 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer.
Training neural network.
2016-11-21 03:57:40,766 _log_update: [1000] (38.0 %) of epoch 1 -- lr = 2e+01, cost = 3.65, duration = 112.3 ms
2016-11-21 04:11:37,404 _log_update: [2000] (76.0 %) of epoch 1 -- lr = 2e+01, cost = 3.14, duration = 62.1 ms
2016-11-21 04:20:24,222 _validate: [2621] First validation sample, perplexity 259.93.
2016-11-21 04:20:56,378 _validate: [2625] Center of validation, perplexity 278.34.
2016-11-21 04:21:35,316 _validate: [2630] Last validation sample, perplexity 278.57.
2016-11-21 04:21:35,341 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 04:21:35,341 _log_validation: [2630] Validation set cost history: [273.0]
2016-11-21 04:21:35,341 _reset: Generating a random order of input lines.
Finished training epoch 1. Best validation perplexity 273.01.
2016-11-21 04:26:46,512 _log_update: [370] (14.1 %) of epoch 2 -- lr = 2e+01, cost = 2.98, duration = 95.4 ms
2016-11-21 04:40:56,404 _log_update: [1370] (52.1 %) of epoch 2 -- lr = 2e+01, cost = 3.05, duration = 90.0 ms
2016-11-21 04:54:53,809 _log_update: [2370] (90.1 %) of epoch 2 -- lr = 2e+01, cost = 2.83, duration = 85.7 ms
2016-11-21 04:58:34,833 _validate: [2621] First validation sample, perplexity 205.03.
2016-11-21 04:59:06,386 _validate: [2625] Center of validation, perplexity 207.96.
2016-11-21 04:59:45,382 _validate: [2630] Last validation sample, perplexity 219.31.
2016-11-21 04:59:45,401 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 04:59:45,401 _log_validation: [2630] Validation set cost history: 273.0 [217.0]
2016-11-21 04:59:45,402 _reset: Generating a random order of input lines.
Finished training epoch 2. Best validation perplexity 217.04.
2016-11-21 05:10:14,327 _log_update: [740] (28.1 %) of epoch 3 -- lr = 2e+01, cost = 2.89, duration = 69.6 ms
2016-11-21 05:24:09,053 _log_update: [1740] (66.2 %) of epoch 3 -- lr = 2e+01, cost = 2.62, duration = 79.3 ms
2016-11-21 05:36:38,948 _validate: [2621] First validation sample, perplexity 185.21.
2016-11-21 05:37:10,420 _validate: [2625] Center of validation, perplexity 181.18.
2016-11-21 05:37:48,845 _validate: [2630] Last validation sample, perplexity 607.14.
2016-11-21 05:37:48,845 _log_validation: [2630] Validation set cost history: 273.0 [217.0] 231.0
2016-11-21 05:37:48,846 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-21 05:37:48,848 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-21 05:37:48,849 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-21 05:37:48,850 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-21 05:37:48,851 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-21 05:37:48,851 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-21 05:37:48,853 _reset_state: [2625] (99.81 %) of epoch 2
2016-11-21 05:37:48,853 _log_validation: [2625] Validation set cost history: 273.0 [217.0]
2016-11-21 05:37:48,853 set_state: Restored iterator to line 42000 of 42068.
2016-11-21 05:37:48,854 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-21 05:37:48,857 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-21 05:37:48,858 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-21 05:37:48,859 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-21 05:37:48,860 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-21 05:37:48,860 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 20.0 to 10.0 and resetting state to 100 % of epoch 2.
2016-11-21 05:37:48,861 _reset: Generating a random order of input lines.
Finished training epoch 2. Best validation perplexity 217.04.
2016-11-21 05:39:22,788 _log_update: [110] (4.2 %) of epoch 3 -- lr = 1e+01, cost = 2.77, duration = 89.8 ms
2016-11-21 05:53:29,180 _log_update: [1110] (42.2 %) of epoch 3 -- lr = 1e+01, cost = 2.59, duration = 84.4 ms
2016-11-21 06:08:42,540 _log_update: [2110] (80.2 %) of epoch 3 -- lr = 1e+01, cost = 2.77, duration = 93.1 ms
2016-11-21 06:17:09,631 _validate: [2621] First validation sample, perplexity 172.62.
2016-11-21 06:18:08,922 _validate: [2625] Center of validation, perplexity 170.63.
2016-11-21 06:19:21,650 _validate: [2630] Last validation sample, perplexity 180.31.
2016-11-21 06:19:21,667 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 06:19:21,667 _log_validation: [2630] Validation set cost history: 273.0 217.0 [171.4]
2016-11-21 06:19:21,668 _reset: Generating a random order of input lines.
Finished training epoch 3. Best validation perplexity 171.36.
2016-11-21 06:27:05,733 _log_update: [480] (18.3 %) of epoch 4 -- lr = 1e+01, cost = 2.80, duration = 117.7 ms
2016-11-21 06:41:42,688 _log_update: [1480] (56.3 %) of epoch 4 -- lr = 1e+01, cost = 2.51, duration = 83.2 ms
2016-11-21 06:55:40,443 _log_update: [2480] (94.3 %) of epoch 4 -- lr = 1e+01, cost = 2.42, duration = 83.7 ms
2016-11-21 06:57:44,549 _validate: [2621] First validation sample, perplexity 161.94.
2016-11-21 06:58:15,807 _validate: [2625] Center of validation, perplexity 162.10.
2016-11-21 06:58:54,234 _validate: [2630] Last validation sample, perplexity 171.40.
2016-11-21 06:58:54,251 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 06:58:54,251 _log_validation: [2630] Validation set cost history: 273.0 217.0 171.4 [163.7]
2016-11-21 06:58:54,252 _reset: Generating a random order of input lines.
Finished training epoch 4. Best validation perplexity 163.69.
2016-11-21 07:10:58,896 _log_update: [850] (32.3 %) of epoch 5 -- lr = 1e+01, cost = 2.30, duration = 87.0 ms
2016-11-21 07:24:54,853 _log_update: [1850] (70.3 %) of epoch 5 -- lr = 1e+01, cost = 2.28, duration = 68.7 ms
2016-11-21 07:35:46,868 _validate: [2621] First validation sample, perplexity 156.07.
2016-11-21 07:36:17,950 _validate: [2625] Center of validation, perplexity 154.92.
2016-11-21 07:36:56,821 _validate: [2630] Last validation sample, perplexity 161.79.
2016-11-21 07:36:56,838 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 07:36:56,838 _log_validation: [2630] Validation set cost history: 273.0 217.0 171.4 163.7 [156.2]
2016-11-21 07:36:56,839 _reset: Generating a random order of input lines.
Finished training epoch 5. Best validation perplexity 156.20.
2016-11-21 07:40:02,754 _log_update: [220] (8.4 %) of epoch 6 -- lr = 1e+01, cost = 2.31, duration = 64.7 ms
2016-11-21 07:54:06,392 _log_update: [1220] (46.4 %) of epoch 6 -- lr = 1e+01, cost = 2.55, duration = 94.2 ms
2016-11-21 08:08:12,294 _log_update: [2220] (84.4 %) of epoch 6 -- lr = 1e+01, cost = 2.26, duration = 75.3 ms
2016-11-21 08:13:51,688 _validate: [2621] First validation sample, perplexity 151.95.
2016-11-21 08:14:22,870 _validate: [2625] Center of validation, perplexity 152.93.
2016-11-21 08:15:01,880 _validate: [2630] Last validation sample, perplexity 157.17.
2016-11-21 08:15:01,897 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 08:15:01,897 _log_validation: [2630] Validation set cost history: 273.0 217.0 171.4 163.7 156.2 [152.8]
2016-11-21 08:15:01,898 _reset: Generating a random order of input lines.
Finished training epoch 6. Best validation perplexity 152.77.
2016-11-21 08:23:24,020 _log_update: [590] (22.4 %) of epoch 7 -- lr = 1e+01, cost = 2.39, duration = 84.4 ms
2016-11-21 08:37:26,968 _log_update: [1590] (60.5 %) of epoch 7 -- lr = 1e+01, cost = 2.50, duration = 67.1 ms
2016-11-21 08:51:25,302 _log_update: [2590] (98.5 %) of epoch 7 -- lr = 1e+01, cost = 2.20, duration = 69.9 ms
2016-11-21 08:51:58,698 _validate: [2621] First validation sample, perplexity 149.59.
2016-11-21 08:52:30,074 _validate: [2625] Center of validation, perplexity 150.29.
2016-11-21 08:53:09,178 _validate: [2630] Last validation sample, perplexity 157.46.
2016-11-21 08:53:09,195 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 08:53:09,195 _log_validation: [2630] Validation set cost history: 273.0 217.0 171.4 163.7 156.2 152.8 [150.9]
2016-11-21 08:53:09,195 _reset: Generating a random order of input lines.
Finished training epoch 7. Best validation perplexity 150.93.
2016-11-21 09:06:37,807 _log_update: [960] (36.5 %) of epoch 8 -- lr = 1e+01, cost = 2.34, duration = 64.5 ms
2016-11-21 09:20:27,583 _log_update: [1960] (74.5 %) of epoch 8 -- lr = 1e+01, cost = 2.48, duration = 84.8 ms
2016-11-21 09:29:54,203 _validate: [2621] First validation sample, perplexity 146.92.
2016-11-21 09:30:26,064 _validate: [2625] Center of validation, perplexity 146.87.
2016-11-21 09:31:05,318 _validate: [2630] Last validation sample, perplexity 151.31.
2016-11-21 09:31:05,335 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 09:31:05,336 _log_validation: [2630] Validation set cost history: 273.0 217.0 171.4 163.7 156.2 152.8 150.9 [147.1]
2016-11-21 09:31:05,336 _reset: Generating a random order of input lines.
Finished training epoch 8. Best validation perplexity 147.09.
2016-11-21 09:35:44,369 _log_update: [330] (12.5 %) of epoch 9 -- lr = 1e+01, cost = 2.56, duration = 69.6 ms
2016-11-21 09:49:45,119 _log_update: [1330] (50.6 %) of epoch 9 -- lr = 1e+01, cost = 2.26, duration = 85.6 ms
