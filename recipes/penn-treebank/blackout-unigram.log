THEANO_FLAGS=floatX=float32,device=gpu,nvcc.fastmath=True,optimizer=None
/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Enabled computing test values for tensor variables.
Warning: GpuArray backend will fail random number generation!
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-25 09:34:21,811 train: TRAINING OPTIONS
2016-11-25 09:34:21,811 train: max_annealing_count: 0
2016-11-25 09:34:21,812 train: max_epochs: 15
2016-11-25 09:34:21,812 train: min_epochs: 1
2016-11-25 09:34:21,812 train: batch_size: 32
2016-11-25 09:34:21,812 train: stopping_criterion: no-improvement
2016-11-25 09:34:21,812 train: sequence_length: 25
2016-11-25 09:34:21,812 train: patience: 0
2016-11-25 09:34:21,812 train: validation_frequency: 1
2016-11-25 09:34:21,812 train: OPTIMIZATION OPTIONS
2016-11-25 09:34:21,812 train: gradient_decay_rate: 0.9
2016-11-25 09:34:21,812 train: learning_rate: 10.0
2016-11-25 09:34:21,812 train: cost_function: blackout
2016-11-25 09:34:21,812 train: sqr_gradient_decay_rate: 0.999
2016-11-25 09:34:21,812 train: ignore_unk: False
2016-11-25 09:34:21,812 train: momentum: 0.9
2016-11-25 09:34:21,812 train: method: sgd
2016-11-25 09:34:21,812 train: max_gradient_norm: 5.0
2016-11-25 09:34:21,812 train: num_noise_samples: 25
2016-11-25 09:34:21,812 train: unk_penalty: None
2016-11-25 09:34:21,812 train: epsilon: 1e-06
2016-11-25 09:34:21,812 train: weights: [ 1.]
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-25 09:34:22,963 __init__: One epoch of training data contains 1778 mini-batch updates.
2016-11-25 09:34:22,964 __init__: Class unigram probabilities are in the range [0.00000103, 0.05232915].
2016-11-25 09:34:22,964 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-25 09:34:23,025 _reset: Generating a random order of input lines.
Building neural network.
2016-11-25 09:34:23,032 __init__: Creating layers.
2016-11-25 09:34:23,032 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-25 09:34:23,032 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-25 09:34:23,071 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-25 09:34:23,187 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-25 09:34:23,304 __init__: Initializing parameters.
2016-11-25 09:34:23,305 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-25 09:34:23,305 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-25 09:34:23,305 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-25 09:34:23,305 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-25 09:34:23,305 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-25 09:34:23,305 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-25 09:34:23,305 __init__: Total number of parameters: 3935925
class_probs (1600, 10001)
class_probs.sum(1) (1600,)
Compiling optimization function.
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2016-11-25 09:37:32,419 _log_update: [200] (11.2 %) of epoch 1 -- lr = 1e+01, cost = 3.83, duration = 91.9 ms
2016-11-25 09:40:36,176 _log_update: [400] (22.5 %) of epoch 1 -- lr = 1e+01, cost = 3.78, duration = 92.5 ms
2016-11-25 09:43:42,426 _log_update: [600] (33.7 %) of epoch 1 -- lr = 1e+01, cost = 3.49, duration = 93.5 ms
2016-11-25 09:46:53,314 _log_update: [800] (45.0 %) of epoch 1 -- lr = 1e+01, cost = 3.41, duration = 93.2 ms
2016-11-25 09:50:01,925 _log_update: [1000] (56.2 %) of epoch 1 -- lr = 1e+01, cost = 3.38, duration = 93.8 ms
2016-11-25 09:53:11,695 _log_update: [1200] (67.5 %) of epoch 1 -- lr = 1e+01, cost = 3.20, duration = 94.6 ms
2016-11-25 09:56:21,634 _log_update: [1400] (78.7 %) of epoch 1 -- lr = 1e+01, cost = 3.19, duration = 94.9 ms
2016-11-25 09:59:31,471 _log_update: [1600] (90.0 %) of epoch 1 -- lr = 1e+01, cost = 2.92, duration = 94.8 ms
2016-11-25 10:02:56,879 _validate: [1772] First validation sample, perplexity 269.32.
2016-11-25 10:05:06,081 _validate: [1775] Center of validation, perplexity 269.25.
2016-11-25 10:07:15,144 _validate: [1778] Last validation sample, perplexity 280.08.
2016-11-25 10:07:15,165 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 10:07:15,166 _log_validation: [1778] Validation set cost history: [269.3]
2016-11-25 10:07:15,166 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 32.8 minutes. Best validation perplexity 269.32.
2016-11-25 10:07:35,824 _log_update: [22] (1.2 %) of epoch 2 -- lr = 1e+01, cost = 2.88, duration = 93.5 ms
2016-11-25 10:10:46,721 _log_update: [222] (12.5 %) of epoch 2 -- lr = 1e+01, cost = 3.00, duration = 105.3 ms
2016-11-25 10:14:15,261 _log_update: [422] (23.7 %) of epoch 2 -- lr = 1e+01, cost = 2.88, duration = 110.8 ms
2016-11-25 10:17:41,897 _log_update: [622] (35.0 %) of epoch 2 -- lr = 1e+01, cost = 2.71, duration = 97.8 ms
2016-11-25 10:21:03,762 _log_update: [822] (46.2 %) of epoch 2 -- lr = 1e+01, cost = 2.76, duration = 99.5 ms
2016-11-25 10:24:21,288 _log_update: [1022] (57.5 %) of epoch 2 -- lr = 1e+01, cost = 2.60, duration = 100.2 ms
2016-11-25 10:27:41,457 _log_update: [1222] (68.7 %) of epoch 2 -- lr = 1e+01, cost = 2.85, duration = 99.1 ms
2016-11-25 10:30:59,817 _log_update: [1422] (80.0 %) of epoch 2 -- lr = 1e+01, cost = 2.62, duration = 98.5 ms
2016-11-25 10:34:17,001 _log_update: [1622] (91.2 %) of epoch 2 -- lr = 1e+01, cost = 2.62, duration = 97.9 ms
2016-11-25 10:37:27,566 _validate: [1772] First validation sample, perplexity 199.69.
2016-11-25 10:39:39,000 _validate: [1775] Center of validation, perplexity 197.94.
2016-11-25 10:41:50,638 _validate: [1778] Last validation sample, perplexity 197.30.
2016-11-25 10:41:50,661 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 10:41:50,661 _log_validation: [1778] Validation set cost history: 269.3 [198.3]
2016-11-25 10:41:50,662 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 34.6 minutes. Best validation perplexity 198.26.
2016-11-25 10:42:33,636 _log_update: [44] (2.5 %) of epoch 3 -- lr = 1e+01, cost = 2.74, duration = 95.1 ms
2016-11-25 10:45:51,787 _log_update: [244] (13.7 %) of epoch 3 -- lr = 1e+01, cost = 2.56, duration = 94.4 ms
2016-11-25 10:49:01,628 _log_update: [444] (25.0 %) of epoch 3 -- lr = 1e+01, cost = 2.32, duration = 94.4 ms
2016-11-25 10:52:12,070 _log_update: [644] (36.2 %) of epoch 3 -- lr = 1e+01, cost = 2.32, duration = 94.5 ms
2016-11-25 10:55:21,534 _log_update: [844] (47.5 %) of epoch 3 -- lr = 1e+01, cost = 2.66, duration = 95.0 ms
2016-11-25 10:58:31,032 _log_update: [1044] (58.7 %) of epoch 3 -- lr = 1e+01, cost = 2.57, duration = 94.7 ms
2016-11-25 11:01:40,782 _log_update: [1244] (70.0 %) of epoch 3 -- lr = 1e+01, cost = 2.55, duration = 94.8 ms
2016-11-25 11:04:50,561 _log_update: [1444] (81.2 %) of epoch 3 -- lr = 1e+01, cost = 2.36, duration = 98.8 ms
2016-11-25 11:08:00,068 _log_update: [1644] (92.5 %) of epoch 3 -- lr = 1e+01, cost = 2.57, duration = 94.1 ms
2016-11-25 11:10:43,324 _validate: [1772] First validation sample, perplexity 170.25.
2016-11-25 11:12:51,488 _validate: [1775] Center of validation, perplexity 170.35.
2016-11-25 11:15:00,913 _validate: [1778] Last validation sample, perplexity 170.36.
2016-11-25 11:15:00,931 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 11:15:00,931 _log_validation: [1778] Validation set cost history: 269.3 198.3 [170.3]
2016-11-25 11:15:00,932 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 33.2 minutes. Best validation perplexity 170.35.
2016-11-25 11:16:03,388 _log_update: [66] (3.7 %) of epoch 4 -- lr = 1e+01, cost = 2.39, duration = 94.8 ms
2016-11-25 11:19:13,425 _log_update: [266] (15.0 %) of epoch 4 -- lr = 1e+01, cost = 2.44, duration = 95.0 ms
2016-11-25 11:22:22,859 _log_update: [466] (26.2 %) of epoch 4 -- lr = 1e+01, cost = 2.50, duration = 93.6 ms
2016-11-25 11:25:31,177 _log_update: [666] (37.5 %) of epoch 4 -- lr = 1e+01, cost = 2.28, duration = 93.8 ms
2016-11-25 11:28:44,678 _log_update: [866] (48.7 %) of epoch 4 -- lr = 1e+01, cost = 2.15, duration = 101.3 ms
2016-11-25 11:32:08,500 _log_update: [1066] (60.0 %) of epoch 4 -- lr = 1e+01, cost = 2.32, duration = 105.9 ms
2016-11-25 11:35:28,378 _log_update: [1266] (71.2 %) of epoch 4 -- lr = 1e+01, cost = 2.51, duration = 98.4 ms
2016-11-25 11:38:42,652 _log_update: [1466] (82.5 %) of epoch 4 -- lr = 1e+01, cost = 2.37, duration = 96.0 ms
2016-11-25 11:41:57,088 _log_update: [1666] (93.7 %) of epoch 4 -- lr = 1e+01, cost = 2.55, duration = 93.6 ms
2016-11-25 11:44:24,278 _validate: [1772] First validation sample, perplexity 158.65.
2016-11-25 11:46:39,178 _validate: [1775] Center of validation, perplexity 156.77.
2016-11-25 11:48:55,369 _validate: [1778] Last validation sample, perplexity 157.75.
2016-11-25 11:48:55,387 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 11:48:55,387 _log_validation: [1778] Validation set cost history: 269.3 198.3 170.3 [158.3]
2016-11-25 11:48:55,388 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 33.9 minutes. Best validation perplexity 158.31.
2016-11-25 11:50:18,576 _log_update: [88] (4.9 %) of epoch 5 -- lr = 1e+01, cost = 2.25, duration = 94.5 ms
2016-11-25 11:53:28,097 _log_update: [288] (16.2 %) of epoch 5 -- lr = 1e+01, cost = 2.28, duration = 94.2 ms
2016-11-25 11:56:37,512 _log_update: [488] (27.4 %) of epoch 5 -- lr = 1e+01, cost = 2.09, duration = 94.8 ms
2016-11-25 11:59:48,878 _log_update: [688] (38.7 %) of epoch 5 -- lr = 1e+01, cost = 2.49, duration = 99.2 ms
2016-11-25 12:03:02,414 _log_update: [888] (49.9 %) of epoch 5 -- lr = 1e+01, cost = 2.32, duration = 94.8 ms
2016-11-25 12:06:14,535 _log_update: [1088] (61.2 %) of epoch 5 -- lr = 1e+01, cost = 2.13, duration = 95.2 ms
2016-11-25 12:09:29,938 _log_update: [1288] (72.4 %) of epoch 5 -- lr = 1e+01, cost = 2.21, duration = 95.1 ms
2016-11-25 12:12:40,365 _log_update: [1488] (83.7 %) of epoch 5 -- lr = 1e+01, cost = 2.24, duration = 95.1 ms
2016-11-25 12:15:49,150 _log_update: [1688] (94.9 %) of epoch 5 -- lr = 1e+01, cost = 2.19, duration = 94.0 ms
2016-11-25 12:17:50,823 _validate: [1772] First validation sample, perplexity 152.38.
2016-11-25 12:19:59,213 _validate: [1775] Center of validation, perplexity 152.20.
2016-11-25 12:22:08,017 _validate: [1778] Last validation sample, perplexity 151.29.
2016-11-25 12:22:08,035 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 12:22:08,035 _log_validation: [1778] Validation set cost history: 269.3 198.3 170.3 158.3 [151.8]
2016-11-25 12:22:08,036 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 33.2 minutes. Best validation perplexity 151.82.
2016-11-25 12:23:51,706 _log_update: [110] (6.2 %) of epoch 6 -- lr = 1e+01, cost = 2.05, duration = 94.3 ms
2016-11-25 12:27:00,637 _log_update: [310] (17.4 %) of epoch 6 -- lr = 1e+01, cost = 2.23, duration = 96.9 ms
2016-11-25 12:30:09,388 _log_update: [510] (28.7 %) of epoch 6 -- lr = 1e+01, cost = 2.33, duration = 93.3 ms
2016-11-25 12:33:18,096 _log_update: [710] (39.9 %) of epoch 6 -- lr = 1e+01, cost = 2.14, duration = 94.3 ms
2016-11-25 12:36:27,419 _log_update: [910] (51.2 %) of epoch 6 -- lr = 1e+01, cost = 2.03, duration = 94.3 ms
2016-11-25 12:39:36,098 _log_update: [1110] (62.4 %) of epoch 6 -- lr = 1e+01, cost = 2.05, duration = 94.1 ms
2016-11-25 12:42:44,923 _log_update: [1310] (73.7 %) of epoch 6 -- lr = 1e+01, cost = 2.04, duration = 96.5 ms
2016-11-25 12:45:56,892 _log_update: [1510] (84.9 %) of epoch 6 -- lr = 1e+01, cost = 2.11, duration = 92.6 ms
2016-11-25 12:49:07,513 _log_update: [1710] (96.2 %) of epoch 6 -- lr = 1e+01, cost = 2.06, duration = 95.4 ms
2016-11-25 12:50:52,458 _validate: [1772] First validation sample, perplexity 148.00.
2016-11-25 12:53:03,765 _validate: [1775] Center of validation, perplexity 147.04.
2016-11-25 12:55:13,873 _validate: [1778] Last validation sample, perplexity 146.40.
2016-11-25 12:55:13,891 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 12:55:13,891 _log_validation: [1778] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 [147.2]
2016-11-25 12:55:13,891 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 33.1 minutes. Best validation perplexity 147.18.
2016-11-25 12:57:23,291 _log_update: [132] (7.4 %) of epoch 7 -- lr = 1e+01, cost = 1.96, duration = 95.1 ms
2016-11-25 13:00:38,072 _log_update: [332] (18.7 %) of epoch 7 -- lr = 1e+01, cost = 1.94, duration = 95.1 ms
2016-11-25 13:03:54,986 _log_update: [532] (29.9 %) of epoch 7 -- lr = 1e+01, cost = 1.96, duration = 97.8 ms
2016-11-25 13:07:17,354 _log_update: [732] (41.2 %) of epoch 7 -- lr = 1e+01, cost = 2.04, duration = 102.9 ms
2016-11-25 13:10:36,616 _log_update: [932] (52.4 %) of epoch 7 -- lr = 1e+01, cost = 2.12, duration = 97.8 ms
2016-11-25 13:13:54,904 _log_update: [1132] (63.7 %) of epoch 7 -- lr = 1e+01, cost = 2.08, duration = 113.3 ms
2016-11-25 13:17:08,915 _log_update: [1332] (74.9 %) of epoch 7 -- lr = 1e+01, cost = 1.98, duration = 96.0 ms
2016-11-25 13:20:18,997 _log_update: [1532] (86.2 %) of epoch 7 -- lr = 1e+01, cost = 2.07, duration = 94.0 ms
2016-11-25 13:23:27,722 _log_update: [1732] (97.4 %) of epoch 7 -- lr = 1e+01, cost = 2.19, duration = 94.3 ms
2016-11-25 13:24:47,119 _validate: [1772] First validation sample, perplexity 147.24.
2016-11-25 13:26:55,015 _validate: [1775] Center of validation, perplexity 147.48.
2016-11-25 13:29:04,213 _validate: [1778] Last validation sample, perplexity 151.74.
2016-11-25 13:29:04,213 _log_validation: [1778] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 [147.2] 147.9
2016-11-25 13:29:04,216 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 13:29:04,217 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 13:29:04,218 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 13:29:04,218 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 13:29:04,219 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 13:29:04,219 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 13:29:04,220 _reset_state: [1775] (99.83 %) of epoch 6
2016-11-25 13:29:04,221 _log_validation: [1775] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 [147.2]
2016-11-25 13:29:04,221 set_state: Restored iterator to line 42004 of 42068.
2016-11-25 13:29:04,222 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-25 13:29:04,222 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-25 13:29:04,225 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-25 13:29:04,227 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-25 13:29:04,227 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-25 13:29:04,228 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 10.0 to 5.0 and resetting state to 100 % of epoch 6.
2016-11-25 13:29:04,228 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 33.8 minutes. Best validation perplexity 147.18.
2016-11-25 13:31:29,313 _log_update: [154] (8.7 %) of epoch 7 -- lr = 5, cost = 1.92, duration = 93.9 ms
2016-11-25 13:34:38,047 _log_update: [354] (19.9 %) of epoch 7 -- lr = 5, cost = 2.09, duration = 94.3 ms
2016-11-25 13:37:47,127 _log_update: [554] (31.2 %) of epoch 7 -- lr = 5, cost = 1.97, duration = 94.3 ms
2016-11-25 13:40:55,879 _log_update: [754] (42.4 %) of epoch 7 -- lr = 5, cost = 1.91, duration = 93.9 ms
2016-11-25 13:44:04,954 _log_update: [954] (53.7 %) of epoch 7 -- lr = 5, cost = 2.10, duration = 96.4 ms
2016-11-25 13:47:16,659 _log_update: [1154] (64.9 %) of epoch 7 -- lr = 5, cost = 1.91, duration = 94.4 ms
2016-11-25 13:50:25,623 _log_update: [1354] (76.2 %) of epoch 7 -- lr = 5, cost = 1.82, duration = 94.2 ms
2016-11-25 13:53:34,619 _log_update: [1554] (87.4 %) of epoch 7 -- lr = 5, cost = 2.09, duration = 94.1 ms
2016-11-25 13:56:43,606 _log_update: [1754] (98.7 %) of epoch 7 -- lr = 5, cost = 2.02, duration = 94.2 ms
2016-11-25 13:57:42,250 _validate: [1772] First validation sample, perplexity 138.35.
2016-11-25 13:59:50,284 _validate: [1775] Center of validation, perplexity 138.71.
2016-11-25 14:01:59,853 _validate: [1778] Last validation sample, perplexity 139.77.
2016-11-25 14:01:59,870 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 14:01:59,871 _log_validation: [1778] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 147.2 [138.7]
2016-11-25 14:01:59,871 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 32.9 minutes. Best validation perplexity 138.71.
2016-11-25 14:04:46,508 _log_update: [176] (9.9 %) of epoch 8 -- lr = 5, cost = 1.84, duration = 94.5 ms
2016-11-25 14:07:55,814 _log_update: [376] (21.1 %) of epoch 8 -- lr = 5, cost = 1.69, duration = 94.6 ms
2016-11-25 14:11:04,776 _log_update: [576] (32.4 %) of epoch 8 -- lr = 5, cost = 1.66, duration = 95.1 ms
2016-11-25 14:14:13,480 _log_update: [776] (43.6 %) of epoch 8 -- lr = 5, cost = 1.68, duration = 94.1 ms
2016-11-25 14:17:22,808 _log_update: [976] (54.9 %) of epoch 8 -- lr = 5, cost = 1.99, duration = 94.9 ms
2016-11-25 14:20:32,974 _log_update: [1176] (66.1 %) of epoch 8 -- lr = 5, cost = 1.80, duration = 95.6 ms
2016-11-25 14:23:42,109 _log_update: [1376] (77.4 %) of epoch 8 -- lr = 5, cost = 2.01, duration = 94.1 ms
2016-11-25 14:26:51,077 _log_update: [1576] (88.6 %) of epoch 8 -- lr = 5, cost = 1.74, duration = 93.8 ms
2016-11-25 14:30:37,446 _validate: [1772] First validation sample, perplexity 138.45.
2016-11-25 14:32:45,348 _validate: [1775] Center of validation, perplexity 138.33.
2016-11-25 14:32:46,296 _log_update: [1776] (99.9 %) of epoch 8 -- lr = 5, cost = 2.01, duration = 93.0 ms
2016-11-25 14:34:53,633 _validate: [1778] Last validation sample, perplexity 138.00.
2016-11-25 14:34:53,651 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 14:34:53,651 _log_validation: [1778] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 147.2 138.7 [138.1]
2016-11-25 14:34:53,652 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 32.9 minutes. Best validation perplexity 138.11.
2016-11-25 14:38:01,637 _log_update: [198] (11.1 %) of epoch 9 -- lr = 5, cost = 1.86, duration = 94.4 ms
2016-11-25 14:41:11,059 _log_update: [398] (22.4 %) of epoch 9 -- lr = 5, cost = 2.01, duration = 93.8 ms
2016-11-25 14:44:20,374 _log_update: [598] (33.6 %) of epoch 9 -- lr = 5, cost = 1.76, duration = 94.4 ms
2016-11-25 14:47:32,953 _log_update: [798] (44.9 %) of epoch 9 -- lr = 5, cost = 1.96, duration = 94.0 ms
2016-11-25 14:50:42,445 _log_update: [998] (56.1 %) of epoch 9 -- lr = 5, cost = 1.91, duration = 94.3 ms
2016-11-25 14:53:52,452 _log_update: [1198] (67.4 %) of epoch 9 -- lr = 5, cost = 2.04, duration = 94.3 ms
2016-11-25 14:57:01,825 _log_update: [1398] (78.6 %) of epoch 9 -- lr = 5, cost = 1.87, duration = 94.1 ms
2016-11-25 15:00:11,455 _log_update: [1598] (89.9 %) of epoch 9 -- lr = 5, cost = 1.96, duration = 94.7 ms
2016-11-25 15:03:38,302 _validate: [1772] First validation sample, perplexity 141.48.
2016-11-25 15:05:46,210 _validate: [1775] Center of validation, perplexity 140.41.
2016-11-25 15:07:54,786 _validate: [1778] Last validation sample, perplexity 141.43.
2016-11-25 15:07:54,787 _log_validation: [1778] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 147.2 138.7 [138.1] 140.6
2016-11-25 15:07:54,790 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 15:07:54,791 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 15:07:54,792 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 15:07:54,792 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 15:07:54,793 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 15:07:54,793 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 15:07:54,794 _reset_state: [1775] (99.83 %) of epoch 8
2016-11-25 15:07:54,794 _log_validation: [1775] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 147.2 138.7 [138.1]
2016-11-25 15:07:54,795 set_state: Restored iterator to line 42001 of 42068.
2016-11-25 15:07:54,795 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-25 15:07:54,796 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-25 15:07:54,799 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-25 15:07:54,800 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-25 15:07:54,801 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-25 15:07:54,801 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 8.
2016-11-25 15:07:54,801 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 33.0 minutes. Best validation perplexity 138.11.
2016-11-25 15:08:13,689 _log_update: [20] (1.1 %) of epoch 9 -- lr = 2, cost = 1.86, duration = 93.5 ms
2016-11-25 15:11:22,537 _log_update: [220] (12.4 %) of epoch 9 -- lr = 2, cost = 1.74, duration = 94.3 ms
2016-11-25 15:14:31,626 _log_update: [420] (23.6 %) of epoch 9 -- lr = 2, cost = 1.79, duration = 94.2 ms
2016-11-25 15:17:41,145 _log_update: [620] (34.9 %) of epoch 9 -- lr = 2, cost = 1.88, duration = 93.8 ms
2016-11-25 15:20:50,682 _log_update: [820] (46.1 %) of epoch 9 -- lr = 2, cost = 1.77, duration = 94.3 ms
2016-11-25 15:23:59,996 _log_update: [1020] (57.4 %) of epoch 9 -- lr = 2, cost = 1.75, duration = 94.5 ms
2016-11-25 15:27:09,807 _log_update: [1220] (68.6 %) of epoch 9 -- lr = 2, cost = 1.96, duration = 95.5 ms
2016-11-25 15:30:19,272 _log_update: [1420] (79.9 %) of epoch 9 -- lr = 2, cost = 1.83, duration = 94.3 ms
2016-11-25 15:33:28,823 _log_update: [1620] (91.1 %) of epoch 9 -- lr = 2, cost = 1.94, duration = 94.4 ms
2016-11-25 15:36:34,501 _validate: [1772] First validation sample, perplexity 137.27.
2016-11-25 15:38:42,311 _validate: [1775] Center of validation, perplexity 137.21.
2016-11-25 15:40:50,635 _validate: [1778] Last validation sample, perplexity 137.30.
2016-11-25 15:40:50,652 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 15:40:50,652 _log_validation: [1778] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 147.2 138.7 138.1 [137.3]
2016-11-25 15:40:50,653 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 32.9 minutes. Best validation perplexity 137.30.
2016-11-25 15:41:30,751 _log_update: [42] (2.4 %) of epoch 10 -- lr = 2, cost = 1.85, duration = 94.3 ms
2016-11-25 15:44:40,221 _log_update: [242] (13.6 %) of epoch 10 -- lr = 2, cost = 1.75, duration = 94.5 ms
2016-11-25 15:47:52,684 _log_update: [442] (24.9 %) of epoch 10 -- lr = 2, cost = 1.75, duration = 94.1 ms
2016-11-25 15:51:02,216 _log_update: [642] (36.1 %) of epoch 10 -- lr = 2, cost = 1.78, duration = 94.4 ms
2016-11-25 15:54:11,135 _log_update: [842] (47.4 %) of epoch 10 -- lr = 2, cost = 1.75, duration = 93.9 ms
2016-11-25 15:57:20,101 _log_update: [1042] (58.6 %) of epoch 10 -- lr = 2, cost = 1.54, duration = 93.7 ms
2016-11-25 16:00:28,877 _log_update: [1242] (69.9 %) of epoch 10 -- lr = 2, cost = 1.69, duration = 94.1 ms
2016-11-25 16:03:38,246 _log_update: [1442] (81.1 %) of epoch 10 -- lr = 2, cost = 1.91, duration = 94.8 ms
2016-11-25 16:06:47,858 _log_update: [1642] (92.4 %) of epoch 10 -- lr = 2, cost = 1.65, duration = 94.3 ms
2016-11-25 16:09:32,322 _validate: [1772] First validation sample, perplexity 139.09.
2016-11-25 16:11:40,074 _validate: [1775] Center of validation, perplexity 138.40.
2016-11-25 16:13:48,225 _validate: [1778] Last validation sample, perplexity 138.36.
2016-11-25 16:13:48,225 _log_validation: [1778] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 147.2 138.7 138.1 [137.3] 138.7
2016-11-25 16:13:48,228 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 16:13:48,230 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 16:13:48,230 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 16:13:48,231 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 16:13:48,231 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 16:13:48,231 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 16:13:48,232 _reset_state: [1775] (99.83 %) of epoch 9
2016-11-25 16:13:48,233 _log_validation: [1775] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 147.2 138.7 138.1 [137.3]
2016-11-25 16:13:48,233 set_state: Restored iterator to line 42001 of 42068.
2016-11-25 16:13:48,234 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-25 16:13:48,234 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-25 16:13:48,237 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-25 16:13:48,239 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-25 16:13:48,239 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-25 16:13:48,239 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 9.
2016-11-25 16:13:48,240 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 33.0 minutes. Best validation perplexity 137.30.
2016-11-25 16:14:48,706 _log_update: [64] (3.6 %) of epoch 10 -- lr = 1, cost = 1.54, duration = 94.2 ms
2016-11-25 16:17:57,748 _log_update: [264] (14.8 %) of epoch 10 -- lr = 1, cost = 1.58, duration = 93.8 ms
2016-11-25 16:21:07,962 _log_update: [464] (26.1 %) of epoch 10 -- lr = 1, cost = 1.71, duration = 94.2 ms
2016-11-25 16:24:16,544 _log_update: [664] (37.3 %) of epoch 10 -- lr = 1, cost = 1.50, duration = 94.6 ms
2016-11-25 16:27:25,603 _log_update: [864] (48.6 %) of epoch 10 -- lr = 1, cost = 1.68, duration = 94.1 ms
2016-11-25 16:30:34,095 _log_update: [1064] (59.8 %) of epoch 10 -- lr = 1, cost = 1.72, duration = 94.0 ms
2016-11-25 16:33:42,998 _log_update: [1264] (71.1 %) of epoch 10 -- lr = 1, cost = 1.69, duration = 94.0 ms
2016-11-25 16:36:52,045 _log_update: [1464] (82.3 %) of epoch 10 -- lr = 1, cost = 1.90, duration = 93.7 ms
2016-11-25 16:40:00,522 _log_update: [1664] (93.6 %) of epoch 10 -- lr = 1, cost = 1.47, duration = 94.5 ms
2016-11-25 16:42:24,229 _validate: [1772] First validation sample, perplexity 137.20.
2016-11-25 16:44:32,496 _validate: [1775] Center of validation, perplexity 137.26.
2016-11-25 16:46:44,964 _validate: [1778] Last validation sample, perplexity 137.56.
2016-11-25 16:46:44,965 _log_validation: [1778] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 147.2 138.7 138.1 [137.3] 137.2
2016-11-25 16:46:44,968 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 16:46:44,969 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 16:46:44,970 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 16:46:44,970 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 16:46:44,971 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 16:46:44,971 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 16:46:44,972 _reset_state: [1775] (99.83 %) of epoch 9
2016-11-25 16:46:44,972 _log_validation: [1775] Validation set cost history: 269.3 198.3 170.3 158.3 151.8 147.2 138.7 138.1 [137.3]
2016-11-25 16:46:44,973 set_state: Restored iterator to line 42001 of 42068.
2016-11-25 16:46:44,973 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-25 16:46:44,974 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-25 16:46:44,977 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-25 16:46:44,978 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-25 16:46:44,979 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-25 16:46:44,979 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 9.
Finished training epoch 9 in 0 hours 32.9 minutes. Best validation perplexity 137.30.
Training finished in 7 hours 12.3 minutes.
2016-11-25 16:46:44,983 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 16:46:44,984 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 16:46:44,985 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 16:46:44,985 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 16:46:44,985 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 16:46:44,986 set_state: layers/output_layer/input/b <- array(10001,)
Best validation set perplexity: 137.206878036
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of predicted probabilities: 82430
Cross entropy (base e): 4.873967693119085
Perplexity: 130.83901745402358
