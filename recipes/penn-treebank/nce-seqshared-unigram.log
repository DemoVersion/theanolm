THEANO_FLAGS=floatX=float32,device=gpu,nvcc.fastmath=True
/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-26 16:16:18,681 train: TRAINING OPTIONS
2016-11-26 16:16:18,681 train: patience: 0
2016-11-26 16:16:18,681 train: validation_frequency: 1
2016-11-26 16:16:18,681 train: max_epochs: 15
2016-11-26 16:16:18,682 train: stopping_criterion: no-improvement
2016-11-26 16:16:18,682 train: min_epochs: 1
2016-11-26 16:16:18,682 train: batch_size: 24
2016-11-26 16:16:18,682 train: max_annealing_count: 0
2016-11-26 16:16:18,682 train: sequence_length: 25
2016-11-26 16:16:18,682 train: OPTIMIZATION OPTIONS
2016-11-26 16:16:18,682 train: momentum: 0.9
2016-11-26 16:16:18,682 train: noise_sharing: seq
2016-11-26 16:16:18,682 train: num_noise_samples: 4
2016-11-26 16:16:18,682 train: max_gradient_norm: 5.0
2016-11-26 16:16:18,682 train: ignore_unk: False
2016-11-26 16:16:18,682 train: cost_function: nce
2016-11-26 16:16:18,682 train: method: sgd
2016-11-26 16:16:18,682 train: gradient_decay_rate: 0.9
2016-11-26 16:16:18,682 train: weights: [ 1.]
2016-11-26 16:16:18,683 train: sqr_gradient_decay_rate: 0.999
2016-11-26 16:16:18,683 train: unk_penalty: None
2016-11-26 16:16:18,683 train: learning_rate: 10.0
2016-11-26 16:16:18,683 train: epsilon: 1e-06
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-26 16:16:19,823 __init__: One epoch of training data contains 2371 mini-batch updates.
2016-11-26 16:16:19,824 __init__: Class unigram probabilities are in the range [0.00000103, 0.05232915].
2016-11-26 16:16:19,824 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-26 16:16:19,847 _reset: Generating a random order of input lines.
Building neural network.
2016-11-26 16:16:19,854 __init__: Creating layers.
2016-11-26 16:16:19,854 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-26 16:16:19,854 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-26 16:16:19,893 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-26 16:16:20,010 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-26 16:16:20,130 __init__: Initializing parameters.
2016-11-26 16:16:20,130 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-26 16:16:20,130 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-26 16:16:20,130 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-26 16:16:20,130 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-26 16:16:20,130 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-26 16:16:20,130 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-26 16:16:20,130 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2016-11-26 16:17:13,686 _log_update: [200] (8.4 %) of epoch 1 -- lr = 1e+01, cost = 2.44, duration = 6.7 ms
2016-11-26 16:17:27,224 _log_update: [400] (16.9 %) of epoch 1 -- lr = 1e+01, cost = 2.30, duration = 6.7 ms
2016-11-26 16:17:40,765 _log_update: [600] (25.3 %) of epoch 1 -- lr = 1e+01, cost = 2.28, duration = 6.7 ms
2016-11-26 16:17:54,304 _log_update: [800] (33.7 %) of epoch 1 -- lr = 1e+01, cost = 2.11, duration = 7.0 ms
2016-11-26 16:18:07,873 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 1e+01, cost = 2.00, duration = 6.7 ms
2016-11-26 16:18:21,418 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 1e+01, cost = 1.89, duration = 6.7 ms
2016-11-26 16:18:34,963 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 1e+01, cost = 2.01, duration = 6.7 ms
2016-11-26 16:18:48,540 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 1e+01, cost = 1.87, duration = 6.7 ms
2016-11-26 16:19:02,094 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 1e+01, cost = 1.85, duration = 6.7 ms
2016-11-26 16:19:15,637 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 1e+01, cost = 1.77, duration = 7.0 ms
2016-11-26 16:19:29,176 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 1e+01, cost = 1.73, duration = 6.6 ms
2016-11-26 16:19:47,342 _validate: [2365] First validation sample, perplexity 386.88.
2016-11-26 16:20:08,339 _validate: [2368] Center of validation, perplexity 395.34.
2016-11-26 16:20:29,478 _validate: [2371] Last validation sample, perplexity 372.07.
2016-11-26 16:20:29,505 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 16:20:29,505 _log_validation: [2371] Validation set cost history: [386.9]
2016-11-26 16:20:29,507 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 3.5 minutes. Best validation perplexity 386.88.
2016-11-26 16:20:31,487 _log_update: [29] (1.2 %) of epoch 2 -- lr = 1e+01, cost = 1.76, duration = 6.7 ms
2016-11-26 16:20:45,024 _log_update: [229] (9.7 %) of epoch 2 -- lr = 1e+01, cost = 1.86, duration = 7.0 ms
2016-11-26 16:20:58,623 _log_update: [429] (18.1 %) of epoch 2 -- lr = 1e+01, cost = 1.88, duration = 6.7 ms
2016-11-26 16:21:12,174 _log_update: [629] (26.5 %) of epoch 2 -- lr = 1e+01, cost = 1.62, duration = 6.7 ms
2016-11-26 16:21:25,720 _log_update: [829] (35.0 %) of epoch 2 -- lr = 1e+01, cost = 1.74, duration = 6.7 ms
2016-11-26 16:21:39,275 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 1e+01, cost = 1.72, duration = 6.7 ms
2016-11-26 16:21:52,819 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 1e+01, cost = 1.70, duration = 6.7 ms
2016-11-26 16:22:06,378 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 1e+01, cost = 1.62, duration = 7.0 ms
2016-11-26 16:22:19,939 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 1e+01, cost = 1.65, duration = 6.7 ms
2016-11-26 16:22:33,490 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 1e+01, cost = 1.62, duration = 6.7 ms
2016-11-26 16:22:47,031 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 1e+01, cost = 1.61, duration = 6.7 ms
2016-11-26 16:23:00,594 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 1e+01, cost = 1.54, duration = 6.7 ms
2016-11-26 16:23:16,745 _validate: [2365] First validation sample, perplexity 285.48.
2016-11-26 16:23:37,813 _validate: [2368] Center of validation, perplexity 318.16.
2016-11-26 16:23:58,803 _validate: [2371] Last validation sample, perplexity 292.67.
2016-11-26 16:23:58,821 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 16:23:58,821 _log_validation: [2371] Validation set cost history: 386.9 [304.5]
2016-11-26 16:23:58,822 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 3.5 minutes. Best validation perplexity 304.50.
2016-11-26 16:24:02,762 _log_update: [58] (2.4 %) of epoch 3 -- lr = 1e+01, cost = 1.57, duration = 6.7 ms
2016-11-26 16:24:16,317 _log_update: [258] (10.9 %) of epoch 3 -- lr = 1e+01, cost = 1.40, duration = 6.7 ms
2016-11-26 16:24:29,867 _log_update: [458] (19.3 %) of epoch 3 -- lr = 1e+01, cost = 1.40, duration = 6.7 ms
2016-11-26 16:24:43,406 _log_update: [658] (27.8 %) of epoch 3 -- lr = 1e+01, cost = 1.55, duration = 6.7 ms
2016-11-26 16:24:56,947 _log_update: [858] (36.2 %) of epoch 3 -- lr = 1e+01, cost = 1.46, duration = 6.7 ms
2016-11-26 16:25:10,496 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 1e+01, cost = 1.61, duration = 6.7 ms
2016-11-26 16:25:24,053 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 1e+01, cost = 1.31, duration = 6.7 ms
2016-11-26 16:25:37,586 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 1e+01, cost = 1.38, duration = 6.7 ms
2016-11-26 16:25:51,125 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 1e+01, cost = 1.58, duration = 6.7 ms
2016-11-26 16:26:04,677 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 1e+01, cost = 1.26, duration = 6.7 ms
2016-11-26 16:26:18,218 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 1e+01, cost = 1.46, duration = 6.7 ms
2016-11-26 16:26:31,753 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 1e+01, cost = 1.43, duration = 6.7 ms
2016-11-26 16:26:45,907 _validate: [2365] First validation sample, perplexity 265.16.
2016-11-26 16:27:06,969 _validate: [2368] Center of validation, perplexity 275.20.
2016-11-26 16:27:28,078 _validate: [2371] Last validation sample, perplexity 260.09.
2016-11-26 16:27:28,094 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 16:27:28,095 _log_validation: [2371] Validation set cost history: 386.9 304.5 [265.2]
2016-11-26 16:27:28,096 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 3.5 minutes. Best validation perplexity 265.16.
2016-11-26 16:27:34,000 _log_update: [87] (3.7 %) of epoch 4 -- lr = 1e+01, cost = 1.27, duration = 6.7 ms
2016-11-26 16:27:47,558 _log_update: [287] (12.1 %) of epoch 4 -- lr = 1e+01, cost = 1.62, duration = 6.7 ms
2016-11-26 16:28:01,108 _log_update: [487] (20.5 %) of epoch 4 -- lr = 1e+01, cost = 1.38, duration = 6.7 ms
2016-11-26 16:28:14,662 _log_update: [687] (29.0 %) of epoch 4 -- lr = 1e+01, cost = 1.33, duration = 7.0 ms
2016-11-26 16:28:28,216 _log_update: [887] (37.4 %) of epoch 4 -- lr = 1e+01, cost = 1.29, duration = 6.7 ms
2016-11-26 16:28:41,753 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 1e+01, cost = 1.38, duration = 6.7 ms
2016-11-26 16:28:55,302 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 1e+01, cost = 1.45, duration = 6.7 ms
2016-11-26 16:29:08,854 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 1e+01, cost = 1.37, duration = 6.7 ms
2016-11-26 16:29:22,398 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 1e+01, cost = 1.44, duration = 6.7 ms
2016-11-26 16:29:35,955 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 1e+01, cost = 1.38, duration = 7.0 ms
2016-11-26 16:29:49,503 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 1e+01, cost = 1.33, duration = 6.7 ms
2016-11-26 16:30:03,061 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 1e+01, cost = 1.24, duration = 6.7 ms
2016-11-26 16:30:15,295 _validate: [2365] First validation sample, perplexity 248.18.
2016-11-26 16:30:36,367 _validate: [2368] Center of validation, perplexity 219.37.
2016-11-26 16:30:57,479 _validate: [2371] Last validation sample, perplexity 220.97.
2016-11-26 16:30:57,495 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 16:30:57,496 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 [220.3]
2016-11-26 16:30:57,497 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 3.5 minutes. Best validation perplexity 220.32.
2016-11-26 16:31:05,381 _log_update: [116] (4.9 %) of epoch 5 -- lr = 1e+01, cost = 1.39, duration = 7.0 ms
2016-11-26 16:31:18,923 _log_update: [316] (13.3 %) of epoch 5 -- lr = 1e+01, cost = 1.11, duration = 6.7 ms
2016-11-26 16:31:32,466 _log_update: [516] (21.8 %) of epoch 5 -- lr = 1e+01, cost = 1.22, duration = 6.7 ms
2016-11-26 16:31:46,001 _log_update: [716] (30.2 %) of epoch 5 -- lr = 1e+01, cost = 1.24, duration = 6.7 ms
2016-11-26 16:31:59,543 _log_update: [916] (38.6 %) of epoch 5 -- lr = 1e+01, cost = 1.35, duration = 6.7 ms
2016-11-26 16:32:13,101 _log_update: [1116] (47.1 %) of epoch 5 -- lr = 1e+01, cost = 1.23, duration = 6.7 ms
2016-11-26 16:32:26,639 _log_update: [1316] (55.5 %) of epoch 5 -- lr = 1e+01, cost = 1.31, duration = 6.7 ms
2016-11-26 16:32:40,188 _log_update: [1516] (63.9 %) of epoch 5 -- lr = 1e+01, cost = 1.43, duration = 6.7 ms
2016-11-26 16:32:53,738 _log_update: [1716] (72.4 %) of epoch 5 -- lr = 1e+01, cost = 1.25, duration = 6.7 ms
2016-11-26 16:33:07,306 _log_update: [1916] (80.8 %) of epoch 5 -- lr = 1e+01, cost = 1.29, duration = 6.7 ms
2016-11-26 16:33:20,846 _log_update: [2116] (89.2 %) of epoch 5 -- lr = 1e+01, cost = 1.14, duration = 6.9 ms
2016-11-26 16:33:34,384 _log_update: [2316] (97.7 %) of epoch 5 -- lr = 1e+01, cost = 1.23, duration = 6.7 ms
2016-11-26 16:33:44,649 _validate: [2365] First validation sample, perplexity 220.53.
2016-11-26 16:34:05,667 _validate: [2368] Center of validation, perplexity 223.79.
2016-11-26 16:34:26,740 _validate: [2371] Last validation sample, perplexity 222.45.
2016-11-26 16:34:26,740 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 [220.3] 223.6
2016-11-26 16:34:26,741 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 16:34:26,741 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 16:34:26,743 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 16:34:26,743 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 16:34:26,744 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 16:34:26,746 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 16:34:26,748 _reset_state: [2368] (99.87 %) of epoch 4
2016-11-26 16:34:26,748 _log_validation: [2368] Validation set cost history: 386.9 304.5 265.2 [220.3]
2016-11-26 16:34:26,748 set_state: Restored iterator to line 42022 of 42068.
2016-11-26 16:34:26,750 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-26 16:34:26,750 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-26 16:34:26,751 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-26 16:34:26,754 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-26 16:34:26,755 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-26 16:34:26,755 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 10.0 to 5.0 and resetting state to 100 % of epoch 4.
2016-11-26 16:34:26,757 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 3.5 minutes. Best validation perplexity 220.32.
2016-11-26 16:34:36,591 _log_update: [145] (6.1 %) of epoch 5 -- lr = 5, cost = 1.20, duration = 6.7 ms
2016-11-26 16:34:50,137 _log_update: [345] (14.6 %) of epoch 5 -- lr = 5, cost = 1.33, duration = 6.6 ms
2016-11-26 16:35:03,687 _log_update: [545] (23.0 %) of epoch 5 -- lr = 5, cost = 1.38, duration = 6.7 ms
2016-11-26 16:35:17,242 _log_update: [745] (31.4 %) of epoch 5 -- lr = 5, cost = 1.17, duration = 6.7 ms
2016-11-26 16:35:30,782 _log_update: [945] (39.9 %) of epoch 5 -- lr = 5, cost = 1.32, duration = 6.7 ms
2016-11-26 16:35:44,338 _log_update: [1145] (48.3 %) of epoch 5 -- lr = 5, cost = 1.21, duration = 6.7 ms
2016-11-26 16:35:57,909 _log_update: [1345] (56.7 %) of epoch 5 -- lr = 5, cost = 1.19, duration = 6.7 ms
2016-11-26 16:36:11,464 _log_update: [1545] (65.2 %) of epoch 5 -- lr = 5, cost = 1.42, duration = 6.7 ms
2016-11-26 16:36:25,022 _log_update: [1745] (73.6 %) of epoch 5 -- lr = 5, cost = 1.32, duration = 6.7 ms
2016-11-26 16:36:38,572 _log_update: [1945] (82.0 %) of epoch 5 -- lr = 5, cost = 1.39, duration = 6.7 ms
2016-11-26 16:36:52,129 _log_update: [2145] (90.5 %) of epoch 5 -- lr = 5, cost = 1.19, duration = 6.7 ms
2016-11-26 16:37:05,694 _log_update: [2345] (98.9 %) of epoch 5 -- lr = 5, cost = 1.16, duration = 6.7 ms
2016-11-26 16:37:13,998 _validate: [2365] First validation sample, perplexity 229.54.
2016-11-26 16:37:35,029 _validate: [2368] Center of validation, perplexity 219.01.
2016-11-26 16:37:56,141 _validate: [2371] Last validation sample, perplexity 215.75.
2016-11-26 16:37:56,157 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 16:37:56,157 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 [216.0]
2016-11-26 16:37:56,158 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 3.5 minutes. Best validation perplexity 215.98.
2016-11-26 16:38:07,967 _log_update: [174] (7.3 %) of epoch 6 -- lr = 5, cost = 1.07, duration = 6.7 ms
2016-11-26 16:38:21,527 _log_update: [374] (15.8 %) of epoch 6 -- lr = 5, cost = 1.21, duration = 6.6 ms
2016-11-26 16:38:35,081 _log_update: [574] (24.2 %) of epoch 6 -- lr = 5, cost = 1.27, duration = 6.7 ms
2016-11-26 16:38:48,653 _log_update: [774] (32.6 %) of epoch 6 -- lr = 5, cost = 1.23, duration = 6.7 ms
2016-11-26 16:39:02,204 _log_update: [974] (41.1 %) of epoch 6 -- lr = 5, cost = 1.34, duration = 6.7 ms
2016-11-26 16:39:15,761 _log_update: [1174] (49.5 %) of epoch 6 -- lr = 5, cost = 1.10, duration = 6.7 ms
2016-11-26 16:39:29,305 _log_update: [1374] (58.0 %) of epoch 6 -- lr = 5, cost = 1.26, duration = 6.7 ms
2016-11-26 16:39:42,856 _log_update: [1574] (66.4 %) of epoch 6 -- lr = 5, cost = 1.23, duration = 6.7 ms
2016-11-26 16:39:56,410 _log_update: [1774] (74.8 %) of epoch 6 -- lr = 5, cost = 1.22, duration = 6.7 ms
2016-11-26 16:40:09,968 _log_update: [1974] (83.3 %) of epoch 6 -- lr = 5, cost = 1.24, duration = 6.9 ms
2016-11-26 16:40:23,518 _log_update: [2174] (91.7 %) of epoch 6 -- lr = 5, cost = 1.32, duration = 6.7 ms
2016-11-26 16:40:43,411 _validate: [2365] First validation sample, perplexity 212.86.
2016-11-26 16:41:04,488 _validate: [2368] Center of validation, perplexity 204.91.
2016-11-26 16:41:25,585 _validate: [2371] Last validation sample, perplexity 209.79.
2016-11-26 16:41:25,601 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 16:41:25,601 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 [209.8]
2016-11-26 16:41:25,602 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 3.5 minutes. Best validation perplexity 209.79.
2016-11-26 16:41:25,815 _log_update: [3] (0.1 %) of epoch 7 -- lr = 5, cost = 1.18, duration = 6.8 ms
2016-11-26 16:41:39,355 _log_update: [203] (8.6 %) of epoch 7 -- lr = 5, cost = 1.16, duration = 6.7 ms
2016-11-26 16:41:52,901 _log_update: [403] (17.0 %) of epoch 7 -- lr = 5, cost = 1.21, duration = 6.7 ms
2016-11-26 16:42:06,455 _log_update: [603] (25.4 %) of epoch 7 -- lr = 5, cost = 1.26, duration = 6.7 ms
2016-11-26 16:42:20,004 _log_update: [803] (33.9 %) of epoch 7 -- lr = 5, cost = 1.24, duration = 6.6 ms
2016-11-26 16:42:33,545 _log_update: [1003] (42.3 %) of epoch 7 -- lr = 5, cost = 1.14, duration = 6.7 ms
2016-11-26 16:42:47,085 _log_update: [1203] (50.7 %) of epoch 7 -- lr = 5, cost = 1.21, duration = 7.0 ms
2016-11-26 16:43:00,635 _log_update: [1403] (59.2 %) of epoch 7 -- lr = 5, cost = 1.34, duration = 6.8 ms
2016-11-26 16:43:14,179 _log_update: [1603] (67.6 %) of epoch 7 -- lr = 5, cost = 1.09, duration = 6.7 ms
2016-11-26 16:43:27,721 _log_update: [1803] (76.0 %) of epoch 7 -- lr = 5, cost = 1.03, duration = 6.7 ms
2016-11-26 16:43:41,271 _log_update: [2003] (84.5 %) of epoch 7 -- lr = 5, cost = 1.18, duration = 6.6 ms
2016-11-26 16:43:54,823 _log_update: [2203] (92.9 %) of epoch 7 -- lr = 5, cost = 1.18, duration = 6.9 ms
2016-11-26 16:44:12,734 _validate: [2365] First validation sample, perplexity 199.45.
2016-11-26 16:44:33,775 _validate: [2368] Center of validation, perplexity 203.37.
2016-11-26 16:44:54,864 _validate: [2371] Last validation sample, perplexity 209.10.
2016-11-26 16:44:54,880 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 16:44:54,880 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 [202.4]
2016-11-26 16:44:54,881 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 3.5 minutes. Best validation perplexity 202.42.
2016-11-26 16:44:57,122 _log_update: [32] (1.3 %) of epoch 8 -- lr = 5, cost = 1.02, duration = 6.7 ms
2016-11-26 16:45:10,772 _log_update: [232] (9.8 %) of epoch 8 -- lr = 5, cost = 1.05, duration = 6.7 ms
2016-11-26 16:45:24,508 _log_update: [432] (18.2 %) of epoch 8 -- lr = 5, cost = 1.04, duration = 6.7 ms
2016-11-26 16:45:38,059 _log_update: [632] (26.7 %) of epoch 8 -- lr = 5, cost = 1.09, duration = 6.7 ms
2016-11-26 16:45:51,609 _log_update: [832] (35.1 %) of epoch 8 -- lr = 5, cost = 1.00, duration = 6.7 ms
2016-11-26 16:46:05,188 _log_update: [1032] (43.5 %) of epoch 8 -- lr = 5, cost = 1.18, duration = 6.7 ms
2016-11-26 16:46:18,741 _log_update: [1232] (52.0 %) of epoch 8 -- lr = 5, cost = 1.02, duration = 6.7 ms
2016-11-26 16:46:32,297 _log_update: [1432] (60.4 %) of epoch 8 -- lr = 5, cost = 1.12, duration = 7.0 ms
2016-11-26 16:46:45,836 _log_update: [1632] (68.8 %) of epoch 8 -- lr = 5, cost = 1.13, duration = 6.6 ms
2016-11-26 16:46:59,379 _log_update: [1832] (77.3 %) of epoch 8 -- lr = 5, cost = 1.04, duration = 6.7 ms
2016-11-26 16:47:12,941 _log_update: [2032] (85.7 %) of epoch 8 -- lr = 5, cost = 1.22, duration = 6.7 ms
2016-11-26 16:47:26,487 _log_update: [2232] (94.1 %) of epoch 8 -- lr = 5, cost = 1.16, duration = 6.7 ms
2016-11-26 16:47:42,414 _validate: [2365] First validation sample, perplexity 202.03.
2016-11-26 16:48:03,443 _validate: [2368] Center of validation, perplexity 197.96.
2016-11-26 16:48:24,551 _validate: [2371] Last validation sample, perplexity 198.88.
2016-11-26 16:48:24,566 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 16:48:24,566 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 [198.0]
2016-11-26 16:48:24,567 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 3.5 minutes. Best validation perplexity 197.96.
2016-11-26 16:48:28,716 _log_update: [61] (2.6 %) of epoch 9 -- lr = 5, cost = 1.13, duration = 6.7 ms
2016-11-26 16:48:42,254 _log_update: [261] (11.0 %) of epoch 9 -- lr = 5, cost = 1.06, duration = 6.7 ms
2016-11-26 16:48:55,788 _log_update: [461] (19.4 %) of epoch 9 -- lr = 5, cost = 1.09, duration = 6.7 ms
2016-11-26 16:49:09,330 _log_update: [661] (27.9 %) of epoch 9 -- lr = 5, cost = 1.25, duration = 6.7 ms
2016-11-26 16:49:22,868 _log_update: [861] (36.3 %) of epoch 9 -- lr = 5, cost = 1.22, duration = 6.7 ms
2016-11-26 16:49:36,402 _log_update: [1061] (44.7 %) of epoch 9 -- lr = 5, cost = 1.17, duration = 6.7 ms
2016-11-26 16:49:49,935 _log_update: [1261] (53.2 %) of epoch 9 -- lr = 5, cost = 1.12, duration = 6.7 ms
2016-11-26 16:50:03,472 _log_update: [1461] (61.6 %) of epoch 9 -- lr = 5, cost = 1.06, duration = 7.0 ms
2016-11-26 16:50:17,018 _log_update: [1661] (70.1 %) of epoch 9 -- lr = 5, cost = 1.21, duration = 6.7 ms
2016-11-26 16:50:30,558 _log_update: [1861] (78.5 %) of epoch 9 -- lr = 5, cost = 1.13, duration = 6.7 ms
2016-11-26 16:50:44,096 _log_update: [2061] (86.9 %) of epoch 9 -- lr = 5, cost = 1.01, duration = 6.7 ms
2016-11-26 16:50:57,634 _log_update: [2261] (95.4 %) of epoch 9 -- lr = 5, cost = 1.20, duration = 6.7 ms
2016-11-26 16:51:11,611 _validate: [2365] First validation sample, perplexity 197.55.
2016-11-26 16:51:32,627 _validate: [2368] Center of validation, perplexity 196.66.
2016-11-26 16:51:53,656 _validate: [2371] Last validation sample, perplexity 207.98.
2016-11-26 16:51:53,671 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 16:51:53,671 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 [197.6]
2016-11-26 16:51:53,672 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 3.5 minutes. Best validation perplexity 197.55.
2016-11-26 16:51:59,770 _log_update: [90] (3.8 %) of epoch 10 -- lr = 5, cost = 1.15, duration = 6.6 ms
2016-11-26 16:52:13,318 _log_update: [290] (12.2 %) of epoch 10 -- lr = 5, cost = 1.18, duration = 7.0 ms
2016-11-26 16:52:26,832 _log_update: [490] (20.7 %) of epoch 10 -- lr = 5, cost = 1.28, duration = 6.7 ms
2016-11-26 16:52:40,357 _log_update: [690] (29.1 %) of epoch 10 -- lr = 5, cost = 1.05, duration = 6.6 ms
2016-11-26 16:52:53,871 _log_update: [890] (37.5 %) of epoch 10 -- lr = 5, cost = 1.03, duration = 6.7 ms
2016-11-26 16:53:07,392 _log_update: [1090] (46.0 %) of epoch 10 -- lr = 5, cost = 0.97, duration = 7.0 ms
2016-11-26 16:53:20,904 _log_update: [1290] (54.4 %) of epoch 10 -- lr = 5, cost = 1.20, duration = 6.6 ms
2016-11-26 16:53:34,414 _log_update: [1490] (62.8 %) of epoch 10 -- lr = 5, cost = 1.01, duration = 6.7 ms
2016-11-26 16:53:47,929 _log_update: [1690] (71.3 %) of epoch 10 -- lr = 5, cost = 1.17, duration = 6.6 ms
2016-11-26 16:54:01,439 _log_update: [1890] (79.7 %) of epoch 10 -- lr = 5, cost = 1.17, duration = 6.6 ms
2016-11-26 16:54:14,953 _log_update: [2090] (88.1 %) of epoch 10 -- lr = 5, cost = 1.04, duration = 6.6 ms
2016-11-26 16:54:28,463 _log_update: [2290] (96.6 %) of epoch 10 -- lr = 5, cost = 1.13, duration = 6.6 ms
2016-11-26 16:54:40,429 _validate: [2365] First validation sample, perplexity 207.99.
2016-11-26 16:55:01,376 _validate: [2368] Center of validation, perplexity 203.52.
2016-11-26 16:55:22,364 _validate: [2371] Last validation sample, perplexity 204.39.
2016-11-26 16:55:22,365 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 [197.6] 204.4
2016-11-26 16:55:22,365 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 16:55:22,366 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 16:55:22,367 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 16:55:22,368 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 16:55:22,368 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 16:55:22,371 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 16:55:22,372 _reset_state: [2368] (99.87 %) of epoch 9
2016-11-26 16:55:22,373 _log_validation: [2368] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 [197.6]
2016-11-26 16:55:22,373 set_state: Restored iterator to line 42023 of 42068.
2016-11-26 16:55:22,374 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-26 16:55:22,375 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-26 16:55:22,375 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-26 16:55:22,379 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-26 16:55:22,379 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-26 16:55:22,380 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 9.
2016-11-26 16:55:22,381 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 3.5 minutes. Best validation perplexity 197.55.
2016-11-26 16:55:30,420 _log_update: [119] (5.0 %) of epoch 10 -- lr = 2, cost = 0.98, duration = 6.6 ms
2016-11-26 16:55:43,927 _log_update: [319] (13.5 %) of epoch 10 -- lr = 2, cost = 1.14, duration = 6.7 ms
2016-11-26 16:55:57,446 _log_update: [519] (21.9 %) of epoch 10 -- lr = 2, cost = 1.08, duration = 6.6 ms
2016-11-26 16:56:10,961 _log_update: [719] (30.3 %) of epoch 10 -- lr = 2, cost = 0.99, duration = 6.7 ms
2016-11-26 16:56:24,470 _log_update: [919] (38.8 %) of epoch 10 -- lr = 2, cost = 1.07, duration = 6.7 ms
2016-11-26 16:56:37,971 _log_update: [1119] (47.2 %) of epoch 10 -- lr = 2, cost = 0.94, duration = 6.7 ms
2016-11-26 16:56:51,477 _log_update: [1319] (55.6 %) of epoch 10 -- lr = 2, cost = 1.04, duration = 6.7 ms
2016-11-26 16:57:04,981 _log_update: [1519] (64.1 %) of epoch 10 -- lr = 2, cost = 1.17, duration = 6.6 ms
2016-11-26 16:57:18,486 _log_update: [1719] (72.5 %) of epoch 10 -- lr = 2, cost = 1.00, duration = 6.7 ms
2016-11-26 16:57:31,987 _log_update: [1919] (80.9 %) of epoch 10 -- lr = 2, cost = 1.06, duration = 6.7 ms
2016-11-26 16:57:45,496 _log_update: [2119] (89.4 %) of epoch 10 -- lr = 2, cost = 1.00, duration = 6.9 ms
2016-11-26 16:57:59,008 _log_update: [2319] (97.8 %) of epoch 10 -- lr = 2, cost = 1.08, duration = 6.7 ms
2016-11-26 16:58:09,023 _validate: [2365] First validation sample, perplexity 195.00.
2016-11-26 16:58:29,993 _validate: [2368] Center of validation, perplexity 195.84.
2016-11-26 16:58:50,942 _validate: [2371] Last validation sample, perplexity 201.36.
2016-11-26 16:58:50,957 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 16:58:50,957 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 [195.8]
2016-11-26 16:58:50,958 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 3.5 minutes. Best validation perplexity 195.84.
2016-11-26 16:59:00,966 _log_update: [148] (6.2 %) of epoch 11 -- lr = 2, cost = 1.07, duration = 6.6 ms
2016-11-26 16:59:14,477 _log_update: [348] (14.7 %) of epoch 11 -- lr = 2, cost = 1.10, duration = 6.9 ms
2016-11-26 16:59:27,984 _log_update: [548] (23.1 %) of epoch 11 -- lr = 2, cost = 0.89, duration = 6.7 ms
2016-11-26 16:59:41,495 _log_update: [748] (31.5 %) of epoch 11 -- lr = 2, cost = 0.94, duration = 6.7 ms
2016-11-26 16:59:55,015 _log_update: [948] (40.0 %) of epoch 11 -- lr = 2, cost = 1.10, duration = 6.7 ms
2016-11-26 17:00:08,539 _log_update: [1148] (48.4 %) of epoch 11 -- lr = 2, cost = 0.89, duration = 6.6 ms
2016-11-26 17:00:22,066 _log_update: [1348] (56.9 %) of epoch 11 -- lr = 2, cost = 1.02, duration = 6.6 ms
2016-11-26 17:00:35,565 _log_update: [1548] (65.3 %) of epoch 11 -- lr = 2, cost = 1.04, duration = 6.6 ms
2016-11-26 17:00:49,073 _log_update: [1748] (73.7 %) of epoch 11 -- lr = 2, cost = 1.05, duration = 7.0 ms
2016-11-26 17:01:02,591 _log_update: [1948] (82.2 %) of epoch 11 -- lr = 2, cost = 1.11, duration = 6.7 ms
2016-11-26 17:01:16,096 _log_update: [2148] (90.6 %) of epoch 11 -- lr = 2, cost = 1.10, duration = 6.7 ms
2016-11-26 17:01:29,594 _log_update: [2348] (99.0 %) of epoch 11 -- lr = 2, cost = 0.92, duration = 6.7 ms
2016-11-26 17:01:37,653 _validate: [2365] First validation sample, perplexity 193.04.
2016-11-26 17:01:58,594 _validate: [2368] Center of validation, perplexity 194.12.
2016-11-26 17:02:19,616 _validate: [2371] Last validation sample, perplexity 203.88.
2016-11-26 17:02:19,631 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 17:02:19,631 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 [194.1]
2016-11-26 17:02:19,632 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 3.5 minutes. Best validation perplexity 194.12.
2016-11-26 17:02:31,592 _log_update: [177] (7.5 %) of epoch 12 -- lr = 2, cost = 0.97, duration = 6.7 ms
2016-11-26 17:02:45,101 _log_update: [377] (15.9 %) of epoch 12 -- lr = 2, cost = 1.05, duration = 6.7 ms
2016-11-26 17:02:58,602 _log_update: [577] (24.3 %) of epoch 12 -- lr = 2, cost = 0.99, duration = 6.6 ms
2016-11-26 17:03:12,114 _log_update: [777] (32.8 %) of epoch 12 -- lr = 2, cost = 0.97, duration = 6.9 ms
2016-11-26 17:03:25,620 _log_update: [977] (41.2 %) of epoch 12 -- lr = 2, cost = 1.12, duration = 6.6 ms
2016-11-26 17:03:39,124 _log_update: [1177] (49.6 %) of epoch 12 -- lr = 2, cost = 0.93, duration = 6.6 ms
2016-11-26 17:03:52,626 _log_update: [1377] (58.1 %) of epoch 12 -- lr = 2, cost = 1.22, duration = 6.6 ms
2016-11-26 17:04:06,148 _log_update: [1577] (66.5 %) of epoch 12 -- lr = 2, cost = 1.05, duration = 6.7 ms
2016-11-26 17:04:19,658 _log_update: [1777] (74.9 %) of epoch 12 -- lr = 2, cost = 1.07, duration = 6.6 ms
2016-11-26 17:04:33,178 _log_update: [1977] (83.4 %) of epoch 12 -- lr = 2, cost = 1.04, duration = 6.6 ms
2016-11-26 17:04:46,684 _log_update: [2177] (91.8 %) of epoch 12 -- lr = 2, cost = 1.09, duration = 6.6 ms
2016-11-26 17:05:06,291 _validate: [2365] First validation sample, perplexity 188.97.
2016-11-26 17:05:27,209 _validate: [2368] Center of validation, perplexity 200.10.
2016-11-26 17:05:48,178 _validate: [2371] Last validation sample, perplexity 199.88.
2016-11-26 17:05:48,178 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 [194.1] 199.9
2016-11-26 17:05:48,178 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 17:05:48,179 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 17:05:48,180 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 17:05:48,181 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 17:05:48,181 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 17:05:48,184 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 17:05:48,185 _reset_state: [2368] (99.87 %) of epoch 11
2016-11-26 17:05:48,186 _log_validation: [2368] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 [194.1]
2016-11-26 17:05:48,186 set_state: Restored iterator to line 42021 of 42068.
2016-11-26 17:05:48,187 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-26 17:05:48,188 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-26 17:05:48,189 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-26 17:05:48,192 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-26 17:05:48,192 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-26 17:05:48,193 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 11.
2016-11-26 17:05:48,194 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 3.5 minutes. Best validation perplexity 194.12.
2016-11-26 17:05:48,609 _log_update: [6] (0.3 %) of epoch 12 -- lr = 1, cost = 1.01, duration = 6.7 ms
2016-11-26 17:06:02,150 _log_update: [206] (8.7 %) of epoch 12 -- lr = 1, cost = 1.05, duration = 6.7 ms
2016-11-26 17:06:15,671 _log_update: [406] (17.1 %) of epoch 12 -- lr = 1, cost = 1.02, duration = 6.7 ms
2016-11-26 17:06:29,181 _log_update: [606] (25.6 %) of epoch 12 -- lr = 1, cost = 0.93, duration = 6.7 ms
2016-11-26 17:06:42,701 _log_update: [806] (34.0 %) of epoch 12 -- lr = 1, cost = 0.93, duration = 6.7 ms
2016-11-26 17:06:56,206 _log_update: [1006] (42.4 %) of epoch 12 -- lr = 1, cost = 0.85, duration = 6.7 ms
2016-11-26 17:07:09,725 _log_update: [1206] (50.9 %) of epoch 12 -- lr = 1, cost = 0.95, duration = 6.7 ms
2016-11-26 17:07:23,227 _log_update: [1406] (59.3 %) of epoch 12 -- lr = 1, cost = 0.95, duration = 6.7 ms
2016-11-26 17:07:36,737 _log_update: [1606] (67.7 %) of epoch 12 -- lr = 1, cost = 0.94, duration = 6.7 ms
2016-11-26 17:07:50,248 _log_update: [1806] (76.2 %) of epoch 12 -- lr = 1, cost = 1.11, duration = 6.9 ms
2016-11-26 17:08:03,764 _log_update: [2006] (84.6 %) of epoch 12 -- lr = 1, cost = 0.93, duration = 6.7 ms
2016-11-26 17:08:17,276 _log_update: [2206] (93.0 %) of epoch 12 -- lr = 1, cost = 1.00, duration = 6.7 ms
2016-11-26 17:08:34,927 _validate: [2365] First validation sample, perplexity 186.01.
2016-11-26 17:08:55,883 _validate: [2368] Center of validation, perplexity 185.39.
2016-11-26 17:09:16,863 _validate: [2371] Last validation sample, perplexity 182.88.
2016-11-26 17:09:16,879 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 17:09:16,879 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 194.1 [185.3]
2016-11-26 17:09:16,880 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 3.5 minutes. Best validation perplexity 185.34.
2016-11-26 17:09:19,255 _log_update: [35] (1.5 %) of epoch 13 -- lr = 1, cost = 0.92, duration = 6.7 ms
2016-11-26 17:09:32,756 _log_update: [235] (9.9 %) of epoch 13 -- lr = 1, cost = 0.91, duration = 6.7 ms
2016-11-26 17:09:46,270 _log_update: [435] (18.3 %) of epoch 13 -- lr = 1, cost = 0.76, duration = 6.7 ms
2016-11-26 17:09:59,777 _log_update: [635] (26.8 %) of epoch 13 -- lr = 1, cost = 1.02, duration = 6.7 ms
2016-11-26 17:10:13,299 _log_update: [835] (35.2 %) of epoch 13 -- lr = 1, cost = 0.97, duration = 6.9 ms
2016-11-26 17:10:26,809 _log_update: [1035] (43.7 %) of epoch 13 -- lr = 1, cost = 1.01, duration = 6.7 ms
2016-11-26 17:10:40,316 _log_update: [1235] (52.1 %) of epoch 13 -- lr = 1, cost = 1.08, duration = 6.7 ms
2016-11-26 17:10:53,834 _log_update: [1435] (60.5 %) of epoch 13 -- lr = 1, cost = 1.02, duration = 6.7 ms
2016-11-26 17:11:07,344 _log_update: [1635] (69.0 %) of epoch 13 -- lr = 1, cost = 0.98, duration = 6.7 ms
2016-11-26 17:11:20,858 _log_update: [1835] (77.4 %) of epoch 13 -- lr = 1, cost = 1.11, duration = 6.7 ms
2016-11-26 17:11:34,366 _log_update: [2035] (85.8 %) of epoch 13 -- lr = 1, cost = 0.92, duration = 6.7 ms
2016-11-26 17:11:47,871 _log_update: [2235] (94.3 %) of epoch 13 -- lr = 1, cost = 0.98, duration = 6.9 ms
2016-11-26 17:12:03,575 _validate: [2365] First validation sample, perplexity 182.29.
2016-11-26 17:12:24,606 _validate: [2368] Center of validation, perplexity 186.02.
2016-11-26 17:12:45,605 _validate: [2371] Last validation sample, perplexity 185.21.
2016-11-26 17:12:45,621 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 17:12:45,621 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 194.1 185.3 [185.1]
2016-11-26 17:12:45,622 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 3.5 minutes. Best validation perplexity 185.08.
2016-11-26 17:12:49,949 _log_update: [64] (2.7 %) of epoch 14 -- lr = 1, cost = 0.93, duration = 6.7 ms
2016-11-26 17:13:03,463 _log_update: [264] (11.1 %) of epoch 14 -- lr = 1, cost = 0.82, duration = 6.7 ms
2016-11-26 17:13:16,982 _log_update: [464] (19.6 %) of epoch 14 -- lr = 1, cost = 1.07, duration = 6.7 ms
2016-11-26 17:13:30,492 _log_update: [664] (28.0 %) of epoch 14 -- lr = 1, cost = 0.93, duration = 7.0 ms
2016-11-26 17:13:44,012 _log_update: [864] (36.4 %) of epoch 14 -- lr = 1, cost = 0.90, duration = 6.7 ms
2016-11-26 17:13:57,518 _log_update: [1064] (44.9 %) of epoch 14 -- lr = 1, cost = 0.96, duration = 6.7 ms
2016-11-26 17:14:11,046 _log_update: [1264] (53.3 %) of epoch 14 -- lr = 1, cost = 0.91, duration = 6.7 ms
2016-11-26 17:14:24,559 _log_update: [1464] (61.7 %) of epoch 14 -- lr = 1, cost = 0.93, duration = 6.9 ms
2016-11-26 17:14:38,062 _log_update: [1664] (70.2 %) of epoch 14 -- lr = 1, cost = 1.08, duration = 6.7 ms
2016-11-26 17:14:51,573 _log_update: [1864] (78.6 %) of epoch 14 -- lr = 1, cost = 1.01, duration = 6.8 ms
2016-11-26 17:15:05,125 _log_update: [2064] (87.1 %) of epoch 14 -- lr = 1, cost = 0.96, duration = 6.7 ms
2016-11-26 17:15:18,640 _log_update: [2264] (95.5 %) of epoch 14 -- lr = 1, cost = 0.95, duration = 6.9 ms
2016-11-26 17:15:32,383 _validate: [2365] First validation sample, perplexity 188.96.
2016-11-26 17:15:53,358 _validate: [2368] Center of validation, perplexity 190.39.
2016-11-26 17:16:14,426 _validate: [2371] Last validation sample, perplexity 189.19.
2016-11-26 17:16:14,426 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 194.1 185.3 [185.1] 190.4
2016-11-26 17:16:14,426 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 17:16:14,427 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 17:16:14,428 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 17:16:14,429 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 17:16:14,429 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 17:16:14,432 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 17:16:14,433 _reset_state: [2368] (99.87 %) of epoch 13
2016-11-26 17:16:14,434 _log_validation: [2368] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 194.1 185.3 [185.1]
2016-11-26 17:16:14,434 set_state: Restored iterator to line 42023 of 42068.
2016-11-26 17:16:14,435 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-26 17:16:14,436 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-26 17:16:14,436 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-26 17:16:14,440 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-26 17:16:14,440 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-26 17:16:14,441 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 13.
2016-11-26 17:16:14,442 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 3.5 minutes. Best validation perplexity 185.08.
2016-11-26 17:16:20,750 _log_update: [93] (3.9 %) of epoch 14 -- lr = 0.6, cost = 0.94, duration = 7.1 ms
2016-11-26 17:16:34,262 _log_update: [293] (12.4 %) of epoch 14 -- lr = 0.6, cost = 1.01, duration = 6.7 ms
2016-11-26 17:16:47,775 _log_update: [493] (20.8 %) of epoch 14 -- lr = 0.6, cost = 0.85, duration = 6.6 ms
2016-11-26 17:17:01,291 _log_update: [693] (29.2 %) of epoch 14 -- lr = 0.6, cost = 0.98, duration = 6.7 ms
2016-11-26 17:17:14,806 _log_update: [893] (37.7 %) of epoch 14 -- lr = 0.6, cost = 1.03, duration = 6.7 ms
2016-11-26 17:17:28,317 _log_update: [1093] (46.1 %) of epoch 14 -- lr = 0.6, cost = 1.00, duration = 6.6 ms
2016-11-26 17:17:41,826 _log_update: [1293] (54.5 %) of epoch 14 -- lr = 0.6, cost = 0.95, duration = 6.7 ms
2016-11-26 17:17:55,335 _log_update: [1493] (63.0 %) of epoch 14 -- lr = 0.6, cost = 0.92, duration = 6.7 ms
2016-11-26 17:18:08,851 _log_update: [1693] (71.4 %) of epoch 14 -- lr = 0.6, cost = 1.03, duration = 6.7 ms
2016-11-26 17:18:22,362 _log_update: [1893] (79.8 %) of epoch 14 -- lr = 0.6, cost = 0.95, duration = 6.6 ms
2016-11-26 17:18:35,883 _log_update: [2093] (88.3 %) of epoch 14 -- lr = 0.6, cost = 0.93, duration = 6.7 ms
2016-11-26 17:18:49,424 _log_update: [2293] (96.7 %) of epoch 14 -- lr = 0.6, cost = 1.02, duration = 6.6 ms
2016-11-26 17:19:01,212 _validate: [2365] First validation sample, perplexity 184.29.
2016-11-26 17:19:22,154 _validate: [2368] Center of validation, perplexity 184.04.
2016-11-26 17:19:43,168 _validate: [2371] Last validation sample, perplexity 184.14.
2016-11-26 17:19:43,183 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 17:19:43,183 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 194.1 185.3 185.1 [184.3]
2016-11-26 17:19:43,184 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 3.5 minutes. Best validation perplexity 184.29.
2016-11-26 17:19:51,430 _log_update: [122] (5.1 %) of epoch 15 -- lr = 0.6, cost = 0.92, duration = 6.7 ms
2016-11-26 17:20:04,944 _log_update: [322] (13.6 %) of epoch 15 -- lr = 0.6, cost = 0.86, duration = 6.7 ms
2016-11-26 17:20:18,450 _log_update: [522] (22.0 %) of epoch 15 -- lr = 0.6, cost = 0.99, duration = 6.7 ms
2016-11-26 17:20:31,963 _log_update: [722] (30.5 %) of epoch 15 -- lr = 0.6, cost = 1.00, duration = 6.6 ms
2016-11-26 17:20:45,474 _log_update: [922] (38.9 %) of epoch 15 -- lr = 0.6, cost = 0.90, duration = 6.6 ms
2016-11-26 17:20:59,000 _log_update: [1122] (47.3 %) of epoch 15 -- lr = 0.6, cost = 0.96, duration = 6.7 ms
2016-11-26 17:21:12,521 _log_update: [1322] (55.8 %) of epoch 15 -- lr = 0.6, cost = 0.84, duration = 6.6 ms
2016-11-26 17:21:26,036 _log_update: [1522] (64.2 %) of epoch 15 -- lr = 0.6, cost = 0.91, duration = 6.6 ms
2016-11-26 17:21:39,548 _log_update: [1722] (72.6 %) of epoch 15 -- lr = 0.6, cost = 0.94, duration = 6.7 ms
2016-11-26 17:21:53,061 _log_update: [1922] (81.1 %) of epoch 15 -- lr = 0.6, cost = 1.00, duration = 6.7 ms
2016-11-26 17:22:06,582 _log_update: [2122] (89.5 %) of epoch 15 -- lr = 0.6, cost = 1.08, duration = 6.6 ms
2016-11-26 17:22:20,091 _log_update: [2322] (97.9 %) of epoch 15 -- lr = 0.6, cost = 0.84, duration = 6.6 ms
2016-11-26 17:22:29,906 _validate: [2365] First validation sample, perplexity 188.32.
2016-11-26 17:22:50,860 _validate: [2368] Center of validation, perplexity 187.75.
2016-11-26 17:23:11,824 _validate: [2371] Last validation sample, perplexity 188.78.
2016-11-26 17:23:11,825 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 194.1 185.3 185.1 [184.3] 188.6
2016-11-26 17:23:11,825 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 17:23:11,826 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 17:23:11,827 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 17:23:11,828 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 17:23:11,828 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 17:23:11,831 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 17:23:11,832 _reset_state: [2368] (99.87 %) of epoch 14
2016-11-26 17:23:11,833 _log_validation: [2368] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 194.1 185.3 185.1 [184.3]
2016-11-26 17:23:11,833 set_state: Restored iterator to line 42028 of 42068.
2016-11-26 17:23:11,835 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-26 17:23:11,835 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-26 17:23:11,836 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-26 17:23:11,839 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-26 17:23:11,840 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-26 17:23:11,840 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 14.
2016-11-26 17:23:11,841 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 3.5 minutes. Best validation perplexity 184.29.
2016-11-26 17:23:22,056 _log_update: [151] (6.4 %) of epoch 15 -- lr = 0.3, cost = 0.91, duration = 6.6 ms
2016-11-26 17:23:35,558 _log_update: [351] (14.8 %) of epoch 15 -- lr = 0.3, cost = 0.90, duration = 6.7 ms
2016-11-26 17:23:49,065 _log_update: [551] (23.2 %) of epoch 15 -- lr = 0.3, cost = 0.94, duration = 6.7 ms
2016-11-26 17:24:02,586 _log_update: [751] (31.7 %) of epoch 15 -- lr = 0.3, cost = 0.97, duration = 6.7 ms
2016-11-26 17:24:16,112 _log_update: [951] (40.1 %) of epoch 15 -- lr = 0.3, cost = 0.91, duration = 6.8 ms
2016-11-26 17:24:29,621 _log_update: [1151] (48.5 %) of epoch 15 -- lr = 0.3, cost = 0.90, duration = 6.7 ms
2016-11-26 17:24:43,130 _log_update: [1351] (57.0 %) of epoch 15 -- lr = 0.3, cost = 1.06, duration = 6.7 ms
2016-11-26 17:24:56,636 _log_update: [1551] (65.4 %) of epoch 15 -- lr = 0.3, cost = 0.97, duration = 6.7 ms
2016-11-26 17:25:10,158 _log_update: [1751] (73.9 %) of epoch 15 -- lr = 0.3, cost = 0.90, duration = 7.0 ms
2016-11-26 17:25:23,671 _log_update: [1951] (82.3 %) of epoch 15 -- lr = 0.3, cost = 1.00, duration = 6.6 ms
2016-11-26 17:25:37,182 _log_update: [2151] (90.7 %) of epoch 15 -- lr = 0.3, cost = 0.91, duration = 6.6 ms
2016-11-26 17:25:50,697 _log_update: [2351] (99.2 %) of epoch 15 -- lr = 0.3, cost = 0.91, duration = 6.6 ms
2016-11-26 17:25:58,564 _validate: [2365] First validation sample, perplexity 186.83.
2016-11-26 17:26:19,588 _validate: [2368] Center of validation, perplexity 186.97.
2016-11-26 17:26:40,565 _validate: [2371] Last validation sample, perplexity 187.05.
2016-11-26 17:26:40,566 _log_validation: [2371] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 194.1 185.3 185.1 [184.3] 187.0
2016-11-26 17:26:40,566 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 17:26:40,567 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 17:26:40,568 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 17:26:40,569 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 17:26:40,569 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 17:26:40,572 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 17:26:40,573 _reset_state: [2368] (99.87 %) of epoch 14
2016-11-26 17:26:40,574 _log_validation: [2368] Validation set cost history: 386.9 304.5 265.2 220.3 216.0 209.8 202.4 198.0 197.6 195.8 194.1 185.3 185.1 [184.3]
2016-11-26 17:26:40,574 set_state: Restored iterator to line 42028 of 42068.
2016-11-26 17:26:40,576 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-26 17:26:40,576 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-26 17:26:40,577 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-26 17:26:40,580 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-26 17:26:40,581 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-26 17:26:40,581 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 0.3125 to 0.15625 and resetting state to 100 % of epoch 14.
Finished training epoch 14 in 0 hours 3.5 minutes. Best validation perplexity 184.29.
Training finished in 1 hours 9.7 minutes.
2016-11-26 17:26:40,583 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 17:26:40,583 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 17:26:40,585 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 17:26:40,585 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 17:26:40,586 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 17:26:40,589 set_state: layers/output_layer/input/W <- array(256, 10001)
Best validation set perplexity: 184.041287306
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of predicted probabilities: 82430
Cross entropy (base e): 5.173324677530296
Perplexity: 176.5006709054758
