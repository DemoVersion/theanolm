THEANO_FLAGS=floatX=float32,device=gpu,nvcc.fastmath=True
/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-26 03:42:55,087 train: TRAINING OPTIONS
2016-11-26 03:42:55,087 train: min_epochs: 1
2016-11-26 03:42:55,087 train: max_epochs: 15
2016-11-26 03:42:55,087 train: stopping_criterion: no-improvement
2016-11-26 03:42:55,087 train: validation_frequency: 1
2016-11-26 03:42:55,087 train: max_annealing_count: 0
2016-11-26 03:42:55,087 train: batch_size: 24
2016-11-26 03:42:55,087 train: patience: 0
2016-11-26 03:42:55,087 train: sequence_length: 25
2016-11-26 03:42:55,087 train: OPTIMIZATION OPTIONS
2016-11-26 03:42:55,088 train: ignore_unk: False
2016-11-26 03:42:55,088 train: max_gradient_norm: 5.0
2016-11-26 03:42:55,088 train: gradient_decay_rate: 0.9
2016-11-26 03:42:55,088 train: epsilon: 1e-06
2016-11-26 03:42:55,088 train: unk_penalty: None
2016-11-26 03:42:55,088 train: cost_function: blackout-shared
2016-11-26 03:42:55,088 train: weights: [ 1.]
2016-11-26 03:42:55,088 train: num_noise_samples: 100
2016-11-26 03:42:55,088 train: sqr_gradient_decay_rate: 0.999
2016-11-26 03:42:55,088 train: learning_rate: 5.0
2016-11-26 03:42:55,088 train: momentum: 0.9
2016-11-26 03:42:55,088 train: method: sgd
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-26 03:42:56,266 __init__: One epoch of training data contains 2371 mini-batch updates.
2016-11-26 03:42:56,266 __init__: Class unigram probabilities are in the range [0.00000103, 0.05232915].
2016-11-26 03:42:56,266 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-26 03:42:56,330 _reset: Generating a random order of input lines.
Building neural network.
2016-11-26 03:42:56,337 __init__: Creating layers.
2016-11-26 03:42:56,337 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-26 03:42:56,337 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-26 03:42:56,376 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-26 03:42:56,502 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-26 03:42:56,623 __init__: Initializing parameters.
2016-11-26 03:42:56,624 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-26 03:42:56,624 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-26 03:42:56,624 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-26 03:42:56,624 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-26 03:42:56,624 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-26 03:42:56,624 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-26 03:42:56,624 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2016-11-26 03:44:01,851 _log_update: [200] (8.4 %) of epoch 1 -- lr = 5, cost = 3.43, duration = 6.5 ms
2016-11-26 03:44:15,003 _log_update: [400] (16.9 %) of epoch 1 -- lr = 5, cost = 2.90, duration = 6.6 ms
2016-11-26 03:44:28,158 _log_update: [600] (25.3 %) of epoch 1 -- lr = 5, cost = 4.37, duration = 6.6 ms
2016-11-26 03:44:41,306 _log_update: [800] (33.7 %) of epoch 1 -- lr = 5, cost = 2.69, duration = 6.5 ms
2016-11-26 03:44:54,454 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 5, cost = 2.55, duration = 6.6 ms
2016-11-26 03:45:07,716 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 5, cost = 2.49, duration = 6.6 ms
2016-11-26 03:45:21,074 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 5, cost = 2.77, duration = 6.5 ms
2016-11-26 03:45:34,222 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 5, cost = 3.14, duration = 6.5 ms
2016-11-26 03:45:47,378 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 5, cost = 2.61, duration = 6.6 ms
2016-11-26 03:46:00,557 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 5, cost = 3.05, duration = 6.5 ms
2016-11-26 03:46:13,722 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 5, cost = 3.32, duration = 6.5 ms
2016-11-26 03:46:31,546 _validate: [2365] First validation sample, perplexity 5907.55.
2016-11-26 03:46:52,608 _validate: [2368] Center of validation, perplexity 5602.97.
2016-11-26 03:47:13,300 _validate: [2371] Last validation sample, perplexity 5440.74.
2016-11-26 03:47:13,322 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 03:47:13,322 _log_validation: [2371] Validation set cost history: [5603.0]
2016-11-26 03:47:13,322 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 3.4 minutes. Best validation perplexity 5602.97.
2016-11-26 03:47:15,237 _log_update: [29] (1.2 %) of epoch 2 -- lr = 5, cost = 3.65, duration = 6.5 ms
2016-11-26 03:47:28,377 _log_update: [229] (9.7 %) of epoch 2 -- lr = 5, cost = 2.85, duration = 6.5 ms
2016-11-26 03:47:41,530 _log_update: [429] (18.1 %) of epoch 2 -- lr = 5, cost = 2.75, duration = 6.5 ms
2016-11-26 03:47:54,665 _log_update: [629] (26.5 %) of epoch 2 -- lr = 5, cost = 2.46, duration = 6.6 ms
2016-11-26 03:48:07,807 _log_update: [829] (35.0 %) of epoch 2 -- lr = 5, cost = 4.05, duration = 6.8 ms
2016-11-26 03:48:20,943 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 5, cost = 3.13, duration = 6.5 ms
2016-11-26 03:48:34,109 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 5, cost = 9.68, duration = 6.5 ms
2016-11-26 03:48:47,254 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 5, cost = 2.47, duration = 6.5 ms
2016-11-26 03:49:00,404 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 5, cost = 2.65, duration = 6.5 ms
2016-11-26 03:49:13,553 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 5, cost = 2.25, duration = 6.8 ms
2016-11-26 03:49:26,696 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 5, cost = 3.18, duration = 6.5 ms
2016-11-26 03:49:39,836 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 5, cost = 2.41, duration = 6.5 ms
2016-11-26 03:49:55,724 _validate: [2365] First validation sample, perplexity 1231.07.
2016-11-26 03:50:16,781 _validate: [2368] Center of validation, perplexity 1258.31.
2016-11-26 03:50:37,862 _validate: [2371] Last validation sample, perplexity 1274.37.
2016-11-26 03:50:37,880 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 03:50:37,881 _log_validation: [2371] Validation set cost history: 5603.0 [1258.3]
2016-11-26 03:50:37,882 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 3.4 minutes. Best validation perplexity 1258.31.
2016-11-26 03:50:41,716 _log_update: [58] (2.4 %) of epoch 3 -- lr = 5, cost = 2.59, duration = 6.8 ms
2016-11-26 03:50:54,870 _log_update: [258] (10.9 %) of epoch 3 -- lr = 5, cost = 2.35, duration = 6.5 ms
2016-11-26 03:51:08,019 _log_update: [458] (19.3 %) of epoch 3 -- lr = 5, cost = 3.69, duration = 6.5 ms
2016-11-26 03:51:21,156 _log_update: [658] (27.8 %) of epoch 3 -- lr = 5, cost = 3.53, duration = 6.5 ms
2016-11-26 03:51:34,331 _log_update: [858] (36.2 %) of epoch 3 -- lr = 5, cost = 3.17, duration = 6.5 ms
2016-11-26 03:51:47,478 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 5, cost = 2.48, duration = 6.6 ms
2016-11-26 03:52:00,629 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 5, cost = 1.94, duration = 6.8 ms
2016-11-26 03:52:13,772 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 5, cost = 2.26, duration = 6.5 ms
2016-11-26 03:52:26,925 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 5, cost = 2.30, duration = 6.5 ms
2016-11-26 03:52:40,075 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 5, cost = 2.24, duration = 6.5 ms
2016-11-26 03:52:53,223 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 5, cost = 2.50, duration = 6.5 ms
2016-11-26 03:53:06,369 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 5, cost = 2.58, duration = 6.5 ms
2016-11-26 03:53:20,369 _validate: [2365] First validation sample, perplexity 1144.12.
2016-11-26 03:53:41,445 _validate: [2368] Center of validation, perplexity 1124.46.
2016-11-26 03:54:02,553 _validate: [2371] Last validation sample, perplexity 1125.53.
2016-11-26 03:54:02,572 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 03:54:02,572 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 [1131.0]
2016-11-26 03:54:02,573 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 3.4 minutes. Best validation perplexity 1130.98.
2016-11-26 03:54:08,305 _log_update: [87] (3.7 %) of epoch 4 -- lr = 5, cost = 6.41, duration = 6.5 ms
2016-11-26 03:54:21,448 _log_update: [287] (12.1 %) of epoch 4 -- lr = 5, cost = 2.53, duration = 6.6 ms
2016-11-26 03:54:34,598 _log_update: [487] (20.5 %) of epoch 4 -- lr = 5, cost = 2.62, duration = 6.5 ms
2016-11-26 03:54:47,746 _log_update: [687] (29.0 %) of epoch 4 -- lr = 5, cost = 5.23, duration = 6.8 ms
2016-11-26 03:55:00,890 _log_update: [887] (37.4 %) of epoch 4 -- lr = 5, cost = 2.14, duration = 6.5 ms
2016-11-26 03:55:14,047 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 5, cost = 2.34, duration = 6.5 ms
2016-11-26 03:55:27,194 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 5, cost = 2.58, duration = 6.5 ms
2016-11-26 03:55:40,347 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 5, cost = 2.49, duration = 6.5 ms
2016-11-26 03:55:53,504 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 5, cost = 2.11, duration = 6.7 ms
2016-11-26 03:56:06,677 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 5, cost = 1.98, duration = 6.5 ms
2016-11-26 03:56:19,818 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 5, cost = 2.66, duration = 6.5 ms
2016-11-26 03:56:32,961 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 5, cost = 2.42, duration = 6.5 ms
2016-11-26 03:56:45,020 _validate: [2365] First validation sample, perplexity 785.98.
2016-11-26 03:57:06,047 _validate: [2368] Center of validation, perplexity 789.82.
2016-11-26 03:57:27,096 _validate: [2371] Last validation sample, perplexity 832.70.
2016-11-26 03:57:27,114 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 03:57:27,114 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 [790.4]
2016-11-26 03:57:27,115 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 3.4 minutes. Best validation perplexity 790.36.
2016-11-26 03:57:34,739 _log_update: [116] (4.9 %) of epoch 5 -- lr = 5, cost = 2.94, duration = 6.5 ms
2016-11-26 03:57:47,888 _log_update: [316] (13.3 %) of epoch 5 -- lr = 5, cost = 2.22, duration = 6.6 ms
2016-11-26 03:58:01,036 _log_update: [516] (21.8 %) of epoch 5 -- lr = 5, cost = 2.39, duration = 6.5 ms
2016-11-26 03:58:14,194 _log_update: [716] (30.2 %) of epoch 5 -- lr = 5, cost = 2.29, duration = 6.5 ms
2016-11-26 03:58:27,343 _log_update: [916] (38.6 %) of epoch 5 -- lr = 5, cost = 2.39, duration = 6.5 ms
2016-11-26 03:58:40,492 _log_update: [1116] (47.1 %) of epoch 5 -- lr = 5, cost = 2.22, duration = 6.5 ms
2016-11-26 03:58:53,643 _log_update: [1316] (55.5 %) of epoch 5 -- lr = 5, cost = 2.02, duration = 6.5 ms
2016-11-26 03:59:06,792 _log_update: [1516] (63.9 %) of epoch 5 -- lr = 5, cost = 2.12, duration = 6.5 ms
2016-11-26 03:59:19,937 _log_update: [1716] (72.4 %) of epoch 5 -- lr = 5, cost = 2.11, duration = 6.5 ms
2016-11-26 03:59:33,076 _log_update: [1916] (80.8 %) of epoch 5 -- lr = 5, cost = 2.08, duration = 6.9 ms
2016-11-26 03:59:46,219 _log_update: [2116] (89.2 %) of epoch 5 -- lr = 5, cost = 2.11, duration = 6.5 ms
2016-11-26 03:59:59,368 _log_update: [2316] (97.7 %) of epoch 5 -- lr = 5, cost = 1.93, duration = 6.5 ms
2016-11-26 04:00:09,556 _validate: [2365] First validation sample, perplexity 746.53.
2016-11-26 04:00:30,651 _validate: [2368] Center of validation, perplexity 747.49.
2016-11-26 04:00:51,749 _validate: [2371] Last validation sample, perplexity 753.04.
2016-11-26 04:00:51,766 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 04:00:51,766 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 790.4 [747.5]
2016-11-26 04:00:51,767 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 3.4 minutes. Best validation perplexity 747.49.
2016-11-26 04:01:01,342 _log_update: [145] (6.1 %) of epoch 6 -- lr = 5, cost = 2.95, duration = 6.5 ms
2016-11-26 04:01:14,510 _log_update: [345] (14.6 %) of epoch 6 -- lr = 5, cost = 2.28, duration = 6.6 ms
2016-11-26 04:01:27,667 _log_update: [545] (23.0 %) of epoch 6 -- lr = 5, cost = 2.40, duration = 6.5 ms
2016-11-26 04:01:40,818 _log_update: [745] (31.4 %) of epoch 6 -- lr = 5, cost = 2.22, duration = 6.5 ms
2016-11-26 04:01:53,965 _log_update: [945] (39.9 %) of epoch 6 -- lr = 5, cost = 2.25, duration = 6.5 ms
2016-11-26 04:02:07,131 _log_update: [1145] (48.3 %) of epoch 6 -- lr = 5, cost = 2.03, duration = 6.5 ms
2016-11-26 04:02:20,285 _log_update: [1345] (56.7 %) of epoch 6 -- lr = 5, cost = 1.97, duration = 6.6 ms
2016-11-26 04:02:33,433 _log_update: [1545] (65.2 %) of epoch 6 -- lr = 5, cost = 2.25, duration = 6.9 ms
2016-11-26 04:02:46,568 _log_update: [1745] (73.6 %) of epoch 6 -- lr = 5, cost = 3.85, duration = 6.5 ms
2016-11-26 04:02:59,736 _log_update: [1945] (82.0 %) of epoch 6 -- lr = 5, cost = 2.42, duration = 6.6 ms
2016-11-26 04:03:12,874 _log_update: [2145] (90.5 %) of epoch 6 -- lr = 5, cost = 2.52, duration = 6.5 ms
2016-11-26 04:03:26,016 _log_update: [2345] (98.9 %) of epoch 6 -- lr = 5, cost = 2.20, duration = 6.5 ms
2016-11-26 04:03:34,281 _validate: [2365] First validation sample, perplexity 783.57.
2016-11-26 04:03:55,357 _validate: [2368] Center of validation, perplexity 747.84.
2016-11-26 04:04:16,379 _validate: [2371] Last validation sample, perplexity 752.22.
2016-11-26 04:04:16,379 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 790.4 [747.5] 752.2
2016-11-26 04:04:16,380 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 04:04:16,380 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 04:04:16,383 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 04:04:16,385 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 04:04:16,386 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 04:04:16,386 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 04:04:16,387 _reset_state: [2368] (99.87 %) of epoch 5
2016-11-26 04:04:16,387 _log_validation: [2368] Validation set cost history: 5603.0 1258.3 1131.0 790.4 [747.5]
2016-11-26 04:04:16,388 set_state: Restored iterator to line 42020 of 42068.
2016-11-26 04:04:16,389 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-26 04:04:16,390 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-26 04:04:16,390 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-26 04:04:16,391 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-26 04:04:16,391 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-26 04:04:16,395 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 5.
2016-11-26 04:04:16,396 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 3.4 minutes. Best validation perplexity 747.49.
2016-11-26 04:04:27,839 _log_update: [174] (7.3 %) of epoch 6 -- lr = 2, cost = 1.65, duration = 6.6 ms
2016-11-26 04:04:40,972 _log_update: [374] (15.8 %) of epoch 6 -- lr = 2, cost = 2.30, duration = 6.5 ms
2016-11-26 04:04:54,133 _log_update: [574] (24.2 %) of epoch 6 -- lr = 2, cost = 1.95, duration = 6.5 ms
2016-11-26 04:05:07,279 _log_update: [774] (32.6 %) of epoch 6 -- lr = 2, cost = 2.12, duration = 6.8 ms
2016-11-26 04:05:20,415 _log_update: [974] (41.1 %) of epoch 6 -- lr = 2, cost = 2.16, duration = 6.5 ms
2016-11-26 04:05:33,562 _log_update: [1174] (49.5 %) of epoch 6 -- lr = 2, cost = 2.07, duration = 6.5 ms
2016-11-26 04:05:46,714 _log_update: [1374] (58.0 %) of epoch 6 -- lr = 2, cost = 2.08, duration = 6.5 ms
2016-11-26 04:05:59,870 _log_update: [1574] (66.4 %) of epoch 6 -- lr = 2, cost = 2.41, duration = 6.6 ms
2016-11-26 04:06:13,039 _log_update: [1774] (74.8 %) of epoch 6 -- lr = 2, cost = 2.75, duration = 6.9 ms
2016-11-26 04:06:26,180 _log_update: [1974] (83.3 %) of epoch 6 -- lr = 2, cost = 2.16, duration = 6.5 ms
2016-11-26 04:06:39,320 _log_update: [2174] (91.7 %) of epoch 6 -- lr = 2, cost = 7.82, duration = 6.6 ms
2016-11-26 04:06:58,836 _validate: [2365] First validation sample, perplexity 341.94.
2016-11-26 04:07:19,923 _validate: [2368] Center of validation, perplexity 343.45.
2016-11-26 04:07:40,983 _validate: [2371] Last validation sample, perplexity 345.11.
2016-11-26 04:07:41,000 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 04:07:41,000 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 [343.2]
2016-11-26 04:07:41,001 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 3.4 minutes. Best validation perplexity 343.21.
2016-11-26 04:07:41,208 _log_update: [3] (0.1 %) of epoch 7 -- lr = 2, cost = 1.79, duration = 6.9 ms
2016-11-26 04:07:54,350 _log_update: [203] (8.6 %) of epoch 7 -- lr = 2, cost = 2.36, duration = 6.6 ms
2016-11-26 04:08:07,509 _log_update: [403] (17.0 %) of epoch 7 -- lr = 2, cost = 2.35, duration = 6.5 ms
2016-11-26 04:08:20,657 _log_update: [603] (25.4 %) of epoch 7 -- lr = 2, cost = 4.70, duration = 6.5 ms
2016-11-26 04:08:33,797 _log_update: [803] (33.9 %) of epoch 7 -- lr = 2, cost = 3.02, duration = 6.5 ms
2016-11-26 04:08:46,936 _log_update: [1003] (42.3 %) of epoch 7 -- lr = 2, cost = 2.19, duration = 6.8 ms
2016-11-26 04:09:00,091 _log_update: [1203] (50.7 %) of epoch 7 -- lr = 2, cost = 1.92, duration = 6.8 ms
2016-11-26 04:09:13,239 _log_update: [1403] (59.2 %) of epoch 7 -- lr = 2, cost = 1.98, duration = 6.5 ms
2016-11-26 04:09:26,381 _log_update: [1603] (67.6 %) of epoch 7 -- lr = 2, cost = 2.14, duration = 6.5 ms
2016-11-26 04:09:39,531 _log_update: [1803] (76.0 %) of epoch 7 -- lr = 2, cost = 4.54, duration = 6.6 ms
2016-11-26 04:09:52,688 _log_update: [2003] (84.5 %) of epoch 7 -- lr = 2, cost = 1.93, duration = 6.5 ms
2016-11-26 04:10:05,855 _log_update: [2203] (92.9 %) of epoch 7 -- lr = 2, cost = 1.98, duration = 6.6 ms
2016-11-26 04:10:23,456 _validate: [2365] First validation sample, perplexity 321.38.
2016-11-26 04:10:44,508 _validate: [2368] Center of validation, perplexity 321.95.
2016-11-26 04:11:05,648 _validate: [2371] Last validation sample, perplexity 322.72.
2016-11-26 04:11:05,665 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 04:11:05,665 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 343.2 [321.9]
2016-11-26 04:11:05,666 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 3.4 minutes. Best validation perplexity 321.95.
2016-11-26 04:11:07,780 _log_update: [32] (1.3 %) of epoch 8 -- lr = 2, cost = 1.94, duration = 6.5 ms
2016-11-26 04:11:20,928 _log_update: [232] (9.8 %) of epoch 8 -- lr = 2, cost = 1.91, duration = 6.5 ms
2016-11-26 04:11:34,081 _log_update: [432] (18.2 %) of epoch 8 -- lr = 2, cost = 2.18, duration = 6.6 ms
2016-11-26 04:11:47,224 _log_update: [632] (26.7 %) of epoch 8 -- lr = 2, cost = 1.94, duration = 6.8 ms
2016-11-26 04:12:00,374 _log_update: [832] (35.1 %) of epoch 8 -- lr = 2, cost = 2.53, duration = 6.5 ms
2016-11-26 04:12:13,529 _log_update: [1032] (43.5 %) of epoch 8 -- lr = 2, cost = 2.95, duration = 6.5 ms
2016-11-26 04:12:26,690 _log_update: [1232] (52.0 %) of epoch 8 -- lr = 2, cost = 2.71, duration = 6.5 ms
2016-11-26 04:12:39,834 _log_update: [1432] (60.4 %) of epoch 8 -- lr = 2, cost = 1.86, duration = 6.5 ms
2016-11-26 04:12:52,983 _log_update: [1632] (68.8 %) of epoch 8 -- lr = 2, cost = 1.97, duration = 6.5 ms
2016-11-26 04:13:06,133 _log_update: [1832] (77.3 %) of epoch 8 -- lr = 2, cost = 1.85, duration = 6.6 ms
2016-11-26 04:13:19,286 _log_update: [2032] (85.7 %) of epoch 8 -- lr = 2, cost = 2.33, duration = 6.5 ms
2016-11-26 04:13:32,426 _log_update: [2232] (94.1 %) of epoch 8 -- lr = 2, cost = 3.76, duration = 6.5 ms
2016-11-26 04:13:48,114 _validate: [2365] First validation sample, perplexity 304.51.
2016-11-26 04:14:09,200 _validate: [2368] Center of validation, perplexity 304.15.
2016-11-26 04:14:30,309 _validate: [2371] Last validation sample, perplexity 307.70.
2016-11-26 04:14:30,326 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 04:14:30,326 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 343.2 321.9 [304.5]
2016-11-26 04:14:30,327 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 3.4 minutes. Best validation perplexity 304.51.
2016-11-26 04:14:34,347 _log_update: [61] (2.6 %) of epoch 9 -- lr = 2, cost = 3.34, duration = 6.8 ms
2016-11-26 04:14:47,491 _log_update: [261] (11.0 %) of epoch 9 -- lr = 2, cost = 2.13, duration = 6.5 ms
2016-11-26 04:15:00,634 _log_update: [461] (19.4 %) of epoch 9 -- lr = 2, cost = 1.84, duration = 6.5 ms
2016-11-26 04:15:13,780 _log_update: [661] (27.9 %) of epoch 9 -- lr = 2, cost = 1.80, duration = 6.5 ms
2016-11-26 04:15:26,930 _log_update: [861] (36.3 %) of epoch 9 -- lr = 2, cost = 4.65, duration = 6.5 ms
2016-11-26 04:15:40,078 _log_update: [1061] (44.7 %) of epoch 9 -- lr = 2, cost = 2.23, duration = 6.6 ms
2016-11-26 04:15:53,235 _log_update: [1261] (53.2 %) of epoch 9 -- lr = 2, cost = 1.87, duration = 6.6 ms
2016-11-26 04:16:06,400 _log_update: [1461] (61.6 %) of epoch 9 -- lr = 2, cost = 2.21, duration = 6.5 ms
2016-11-26 04:16:19,550 _log_update: [1661] (70.1 %) of epoch 9 -- lr = 2, cost = 1.93, duration = 6.5 ms
2016-11-26 04:16:32,691 _log_update: [1861] (78.5 %) of epoch 9 -- lr = 2, cost = 2.32, duration = 6.5 ms
2016-11-26 04:16:45,843 _log_update: [2061] (86.9 %) of epoch 9 -- lr = 2, cost = 1.80, duration = 6.5 ms
2016-11-26 04:16:58,970 _log_update: [2261] (95.4 %) of epoch 9 -- lr = 2, cost = 2.03, duration = 6.5 ms
2016-11-26 04:17:12,751 _validate: [2365] First validation sample, perplexity 285.80.
2016-11-26 04:17:33,781 _validate: [2368] Center of validation, perplexity 287.60.
2016-11-26 04:17:54,854 _validate: [2371] Last validation sample, perplexity 288.22.
2016-11-26 04:17:54,871 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 04:17:54,871 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 343.2 321.9 304.5 [287.6]
2016-11-26 04:17:54,872 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 3.4 minutes. Best validation perplexity 287.60.
2016-11-26 04:18:00,808 _log_update: [90] (3.8 %) of epoch 10 -- lr = 2, cost = 2.85, duration = 6.6 ms
2016-11-26 04:18:13,958 _log_update: [290] (12.2 %) of epoch 10 -- lr = 2, cost = 1.81, duration = 6.6 ms
2016-11-26 04:18:27,102 _log_update: [490] (20.7 %) of epoch 10 -- lr = 2, cost = 1.81, duration = 6.5 ms
2016-11-26 04:18:40,248 _log_update: [690] (29.1 %) of epoch 10 -- lr = 2, cost = 1.92, duration = 6.5 ms
2016-11-26 04:18:53,465 _log_update: [890] (37.5 %) of epoch 10 -- lr = 2, cost = 2.19, duration = 6.5 ms
2016-11-26 04:19:06,625 _log_update: [1090] (46.0 %) of epoch 10 -- lr = 2, cost = 1.60, duration = 6.5 ms
2016-11-26 04:19:19,784 _log_update: [1290] (54.4 %) of epoch 10 -- lr = 2, cost = 2.34, duration = 6.5 ms
2016-11-26 04:19:32,939 _log_update: [1490] (62.8 %) of epoch 10 -- lr = 2, cost = 1.97, duration = 6.7 ms
2016-11-26 04:19:46,076 _log_update: [1690] (71.3 %) of epoch 10 -- lr = 2, cost = 1.54, duration = 6.5 ms
2016-11-26 04:19:59,231 _log_update: [1890] (79.7 %) of epoch 10 -- lr = 2, cost = 2.68, duration = 6.5 ms
2016-11-26 04:20:12,395 _log_update: [2090] (88.1 %) of epoch 10 -- lr = 2, cost = 1.93, duration = 6.5 ms
2016-11-26 04:20:25,544 _log_update: [2290] (96.6 %) of epoch 10 -- lr = 2, cost = 1.91, duration = 6.5 ms
2016-11-26 04:20:37,413 _validate: [2365] First validation sample, perplexity 297.20.
2016-11-26 04:20:58,466 _validate: [2368] Center of validation, perplexity 298.49.
2016-11-26 04:21:19,587 _validate: [2371] Last validation sample, perplexity 303.21.
2016-11-26 04:21:19,587 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 343.2 321.9 304.5 [287.6] 298.5
2016-11-26 04:21:19,587 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 04:21:19,588 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 04:21:19,591 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 04:21:19,592 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 04:21:19,593 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 04:21:19,593 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 04:21:19,595 _reset_state: [2368] (99.87 %) of epoch 9
2016-11-26 04:21:19,595 _log_validation: [2368] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 343.2 321.9 304.5 [287.6]
2016-11-26 04:21:19,595 set_state: Restored iterator to line 42023 of 42068.
2016-11-26 04:21:19,597 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-26 04:21:19,597 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-26 04:21:19,598 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-26 04:21:19,598 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-26 04:21:19,599 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-26 04:21:19,602 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 9.
2016-11-26 04:21:19,603 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 3.4 minutes. Best validation perplexity 287.60.
2016-11-26 04:21:27,443 _log_update: [119] (5.0 %) of epoch 10 -- lr = 1, cost = 2.08, duration = 6.5 ms
2016-11-26 04:21:40,588 _log_update: [319] (13.5 %) of epoch 10 -- lr = 1, cost = 2.13, duration = 6.4 ms
2016-11-26 04:21:53,746 _log_update: [519] (21.9 %) of epoch 10 -- lr = 1, cost = 2.11, duration = 6.4 ms
2016-11-26 04:22:06,907 _log_update: [719] (30.3 %) of epoch 10 -- lr = 1, cost = 1.69, duration = 6.4 ms
2016-11-26 04:22:20,050 _log_update: [919] (38.8 %) of epoch 10 -- lr = 1, cost = 1.97, duration = 6.4 ms
2016-11-26 04:22:33,200 _log_update: [1119] (47.2 %) of epoch 10 -- lr = 1, cost = 1.80, duration = 6.8 ms
2016-11-26 04:22:46,337 _log_update: [1319] (55.6 %) of epoch 10 -- lr = 1, cost = 1.75, duration = 6.4 ms
2016-11-26 04:22:59,490 _log_update: [1519] (64.1 %) of epoch 10 -- lr = 1, cost = 2.08, duration = 6.5 ms
2016-11-26 04:23:12,640 _log_update: [1719] (72.5 %) of epoch 10 -- lr = 1, cost = 1.78, duration = 6.4 ms
2016-11-26 04:23:25,780 _log_update: [1919] (80.9 %) of epoch 10 -- lr = 1, cost = 1.75, duration = 6.4 ms
2016-11-26 04:23:38,927 _log_update: [2119] (89.4 %) of epoch 10 -- lr = 1, cost = 1.53, duration = 6.7 ms
2016-11-26 04:23:52,070 _log_update: [2319] (97.8 %) of epoch 10 -- lr = 1, cost = 2.47, duration = 6.4 ms
2016-11-26 04:24:02,046 _validate: [2365] First validation sample, perplexity 229.63.
2016-11-26 04:24:23,102 _validate: [2368] Center of validation, perplexity 229.29.
2016-11-26 04:24:44,156 _validate: [2371] Last validation sample, perplexity 228.64.
2016-11-26 04:24:44,173 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-26 04:24:44,174 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 343.2 321.9 304.5 287.6 [229.4]
2016-11-26 04:24:44,175 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 3.4 minutes. Best validation perplexity 229.37.
2016-11-26 04:24:53,915 _log_update: [148] (6.2 %) of epoch 11 -- lr = 1, cost = 1.92, duration = 6.7 ms
2016-11-26 04:25:07,072 _log_update: [348] (14.7 %) of epoch 11 -- lr = 1, cost = 2.39, duration = 6.4 ms
2016-11-26 04:25:20,220 _log_update: [548] (23.1 %) of epoch 11 -- lr = 1, cost = 1.90, duration = 6.4 ms
2016-11-26 04:25:33,362 _log_update: [748] (31.5 %) of epoch 11 -- lr = 1, cost = 2.15, duration = 6.4 ms
2016-11-26 04:25:46,510 _log_update: [948] (40.0 %) of epoch 11 -- lr = 1, cost = 2.55, duration = 6.4 ms
2016-11-26 04:25:59,665 _log_update: [1148] (48.4 %) of epoch 11 -- lr = 1, cost = 1.77, duration = 6.4 ms
2016-11-26 04:26:12,828 _log_update: [1348] (56.9 %) of epoch 11 -- lr = 1, cost = 2.10, duration = 6.7 ms
2016-11-26 04:26:25,978 _log_update: [1548] (65.3 %) of epoch 11 -- lr = 1, cost = 1.99, duration = 6.5 ms
2016-11-26 04:26:39,133 _log_update: [1748] (73.7 %) of epoch 11 -- lr = 1, cost = 1.84, duration = 6.5 ms
2016-11-26 04:26:52,284 _log_update: [1948] (82.2 %) of epoch 11 -- lr = 1, cost = 1.89, duration = 6.4 ms
2016-11-26 04:27:05,452 _log_update: [2148] (90.6 %) of epoch 11 -- lr = 1, cost = 1.74, duration = 6.5 ms
2016-11-26 04:27:18,599 _log_update: [2348] (99.0 %) of epoch 11 -- lr = 1, cost = 1.49, duration = 6.4 ms
2016-11-26 04:27:26,654 _validate: [2365] First validation sample, perplexity 251.21.
2016-11-26 04:27:47,720 _validate: [2368] Center of validation, perplexity 251.25.
2016-11-26 04:28:08,840 _validate: [2371] Last validation sample, perplexity 251.23.
2016-11-26 04:28:08,840 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 343.2 321.9 304.5 287.6 [229.4] 251.3
2016-11-26 04:28:08,841 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 04:28:08,841 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 04:28:08,844 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 04:28:08,846 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 04:28:08,846 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 04:28:08,847 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 04:28:08,848 _reset_state: [2368] (99.87 %) of epoch 10
2016-11-26 04:28:08,848 _log_validation: [2368] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 343.2 321.9 304.5 287.6 [229.4]
2016-11-26 04:28:08,849 set_state: Restored iterator to line 42019 of 42068.
2016-11-26 04:28:08,850 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-26 04:28:08,851 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-26 04:28:08,851 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-26 04:28:08,852 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-26 04:28:08,852 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-26 04:28:08,855 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 10.
2016-11-26 04:28:08,856 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 3.4 minutes. Best validation perplexity 229.37.
2016-11-26 04:28:20,499 _log_update: [177] (7.5 %) of epoch 11 -- lr = 0.6, cost = 2.63, duration = 6.4 ms
2016-11-26 04:28:33,637 _log_update: [377] (15.9 %) of epoch 11 -- lr = 0.6, cost = 2.12, duration = 6.4 ms
2016-11-26 04:28:46,778 _log_update: [577] (24.3 %) of epoch 11 -- lr = 0.6, cost = 2.14, duration = 6.4 ms
2016-11-26 04:28:59,920 _log_update: [777] (32.8 %) of epoch 11 -- lr = 0.6, cost = 1.46, duration = 6.7 ms
2016-11-26 04:29:13,095 _log_update: [977] (41.2 %) of epoch 11 -- lr = 0.6, cost = 2.42, duration = 6.4 ms
2016-11-26 04:29:26,241 _log_update: [1177] (49.6 %) of epoch 11 -- lr = 0.6, cost = 2.05, duration = 6.5 ms
2016-11-26 04:29:39,379 _log_update: [1377] (58.1 %) of epoch 11 -- lr = 0.6, cost = 2.16, duration = 6.4 ms
2016-11-26 04:29:52,530 _log_update: [1577] (66.5 %) of epoch 11 -- lr = 0.6, cost = 2.35, duration = 6.4 ms
2016-11-26 04:30:05,687 _log_update: [1777] (74.9 %) of epoch 11 -- lr = 0.6, cost = 2.23, duration = 6.4 ms
2016-11-26 04:30:18,829 _log_update: [1977] (83.4 %) of epoch 11 -- lr = 0.6, cost = 1.58, duration = 6.4 ms
2016-11-26 04:30:31,975 _log_update: [2177] (91.8 %) of epoch 11 -- lr = 0.6, cost = 2.31, duration = 6.5 ms
2016-11-26 04:30:51,281 _validate: [2365] First validation sample, perplexity 229.54.
2016-11-26 04:31:12,360 _validate: [2368] Center of validation, perplexity 229.57.
2016-11-26 04:31:33,471 _validate: [2371] Last validation sample, perplexity 229.50.
2016-11-26 04:31:33,471 _log_validation: [2371] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 343.2 321.9 304.5 287.6 [229.4] 229.5
2016-11-26 04:31:33,472 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 04:31:33,472 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 04:31:33,475 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 04:31:33,477 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 04:31:33,477 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 04:31:33,478 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-26 04:31:33,479 _reset_state: [2368] (99.87 %) of epoch 10
2016-11-26 04:31:33,479 _log_validation: [2368] Validation set cost history: 5603.0 1258.3 1131.0 790.4 747.5 343.2 321.9 304.5 287.6 [229.4]
2016-11-26 04:31:33,480 set_state: Restored iterator to line 42019 of 42068.
2016-11-26 04:31:33,481 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-26 04:31:33,482 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-26 04:31:33,482 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-26 04:31:33,483 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-26 04:31:33,483 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-26 04:31:33,486 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 10.
Finished training epoch 10 in 0 hours 3.4 minutes. Best validation perplexity 229.37.
Training finished in 0 hours 47.7 minutes.
2016-11-26 04:31:33,488 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-26 04:31:33,488 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-26 04:31:33,492 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-26 04:31:33,494 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-26 04:31:33,495 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-26 04:31:33,495 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
Best validation set perplexity: 229.289884923
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of predicted probabilities: 82430
Cross entropy (base e): 5.3829663089180215
Perplexity: 217.66698626897937
