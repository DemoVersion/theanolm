/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-22 01:20:10,878 train: TRAINING OPTIONS
2016-11-22 01:20:10,878 train: strategy: local-mean
2016-11-22 01:20:10,878 train: max_epochs: 15
2016-11-22 01:20:10,878 train: sequence_length: 25
2016-11-22 01:20:10,878 train: batch_size: 32
2016-11-22 01:20:10,878 train: validation_frequency: 1
2016-11-22 01:20:10,878 train: stopping_criterion: no-improvement
2016-11-22 01:20:10,878 train: max_annealing_count: 0
2016-11-22 01:20:10,878 train: min_epochs: 1
2016-11-22 01:20:10,878 train: patience: 0
2016-11-22 01:20:10,879 train: OPTIMIZATION OPTIONS
2016-11-22 01:20:10,879 train: learning_rate: 5.0
2016-11-22 01:20:10,879 train: sqr_gradient_decay_rate: 0.999
2016-11-22 01:20:10,879 train: cost_function: nce-shared
2016-11-22 01:20:10,879 train: method: sgd
2016-11-22 01:20:10,879 train: num_noise_samples: 100
2016-11-22 01:20:10,879 train: weights: [ 1.]
2016-11-22 01:20:10,879 train: epsilon: 1e-06
2016-11-22 01:20:10,879 train: unk_penalty: None
2016-11-22 01:20:10,879 train: max_gradient_norm: 5.0
2016-11-22 01:20:10,879 train: gradient_decay_rate: 0.9
2016-11-22 01:20:10,879 train: ignore_unk: False
2016-11-22 01:20:10,879 train: momentum: 0.9
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-22 01:20:12,120 __init__: One epoch of training data contains 1778 mini-batch updates.
2016-11-22 01:20:12,120 __init__: Class unigram probabilities are in the range [0.000001, 0.052329].
2016-11-22 01:20:12,120 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-22 01:20:12,143 _reset: Generating a random order of input lines.
Building neural network.
2016-11-22 01:20:12,150 __init__: Creating layers.
2016-11-22 01:20:12,150 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-22 01:20:12,150 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-22 01:20:12,189 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-22 01:20:12,306 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-22 01:20:12,424 __init__: Initializing parameters.
2016-11-22 01:20:12,424 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-22 01:20:12,424 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-22 01:20:12,424 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-22 01:20:12,424 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-22 01:20:12,424 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-22 01:20:12,424 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-22 01:20:12,424 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer.
Training neural network.
2016-11-22 01:20:36,174 _log_update: [200] (11.2 %) of epoch 1 -- lr = 5, cost = 10.70, duration = 6.6 ms
2016-11-22 01:20:49,517 _log_update: [400] (22.5 %) of epoch 1 -- lr = 5, cost = 8.64, duration = 6.6 ms
2016-11-22 01:21:02,987 _log_update: [600] (33.7 %) of epoch 1 -- lr = 5, cost = 4.16, duration = 6.6 ms
2016-11-22 01:21:16,336 _log_update: [800] (45.0 %) of epoch 1 -- lr = 5, cost = 4.08, duration = 6.6 ms
2016-11-22 01:21:29,701 _log_update: [1000] (56.2 %) of epoch 1 -- lr = 5, cost = 4.42, duration = 6.6 ms
2016-11-22 01:21:43,053 _log_update: [1200] (67.5 %) of epoch 1 -- lr = 5, cost = 3.84, duration = 6.6 ms
2016-11-22 01:21:56,409 _log_update: [1400] (78.7 %) of epoch 1 -- lr = 5, cost = 4.28, duration = 6.6 ms
2016-11-22 01:22:09,778 _log_update: [1600] (90.0 %) of epoch 1 -- lr = 5, cost = 7.85, duration = 6.6 ms
2016-11-22 01:22:27,904 _validate: [1769] First validation sample, perplexity 1804.18.
2016-11-22 01:22:55,019 _validate: [1773] Center of validation, perplexity 1757.90.
2016-11-22 01:23:29,092 _validate: [1778] Last validation sample, perplexity 2085.88.
2016-11-22 01:23:29,118 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 01:23:29,118 _log_validation: [1778] Validation set cost history: [1850.8]
2016-11-22 01:23:29,119 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 3.1 minutes. Best validation perplexity 1850.83.
2016-11-22 01:23:30,603 _log_update: [22] (1.2 %) of epoch 2 -- lr = 5, cost = 4.81, duration = 6.6 ms
2016-11-22 01:23:43,947 _log_update: [222] (12.5 %) of epoch 2 -- lr = 5, cost = 3.42, duration = 6.6 ms
2016-11-22 01:23:57,300 _log_update: [422] (23.7 %) of epoch 2 -- lr = 5, cost = 3.30, duration = 6.6 ms
2016-11-22 01:24:10,658 _log_update: [622] (35.0 %) of epoch 2 -- lr = 5, cost = 3.39, duration = 6.6 ms
2016-11-22 01:24:24,004 _log_update: [822] (46.2 %) of epoch 2 -- lr = 5, cost = 3.21, duration = 6.6 ms
2016-11-22 01:24:37,349 _log_update: [1022] (57.5 %) of epoch 2 -- lr = 5, cost = 3.75, duration = 6.6 ms
2016-11-22 01:24:50,691 _log_update: [1222] (68.7 %) of epoch 2 -- lr = 5, cost = 3.21, duration = 6.6 ms
2016-11-22 01:25:04,053 _log_update: [1422] (80.0 %) of epoch 2 -- lr = 5, cost = 2.86, duration = 6.6 ms
2016-11-22 01:25:17,406 _log_update: [1622] (91.2 %) of epoch 2 -- lr = 5, cost = 2.77, duration = 6.6 ms
2016-11-22 01:25:33,898 _validate: [1769] First validation sample, perplexity 920.12.
2016-11-22 01:26:00,928 _validate: [1773] Center of validation, perplexity 859.67.
2016-11-22 01:26:34,748 _validate: [1778] Last validation sample, perplexity 1005.15.
2016-11-22 01:26:34,766 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 01:26:34,766 _log_validation: [1778] Validation set cost history: 1850.8 [917.7]
2016-11-22 01:26:34,767 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 3.1 minutes. Best validation perplexity 917.72.
2016-11-22 01:26:37,714 _log_update: [44] (2.5 %) of epoch 3 -- lr = 5, cost = 2.98, duration = 6.6 ms
2016-11-22 01:26:51,059 _log_update: [244] (13.7 %) of epoch 3 -- lr = 5, cost = 2.75, duration = 6.6 ms
2016-11-22 01:27:04,422 _log_update: [444] (25.0 %) of epoch 3 -- lr = 5, cost = 2.96, duration = 6.6 ms
2016-11-22 01:27:17,787 _log_update: [644] (36.2 %) of epoch 3 -- lr = 5, cost = 2.98, duration = 6.6 ms
2016-11-22 01:27:31,131 _log_update: [844] (47.5 %) of epoch 3 -- lr = 5, cost = 2.72, duration = 6.6 ms
2016-11-22 01:27:44,490 _log_update: [1044] (58.7 %) of epoch 3 -- lr = 5, cost = 3.25, duration = 6.6 ms
2016-11-22 01:27:57,836 _log_update: [1244] (70.0 %) of epoch 3 -- lr = 5, cost = 3.01, duration = 6.6 ms
2016-11-22 01:28:11,190 _log_update: [1444] (81.2 %) of epoch 3 -- lr = 5, cost = 3.18, duration = 6.6 ms
2016-11-22 01:28:24,531 _log_update: [1644] (92.5 %) of epoch 3 -- lr = 5, cost = 3.10, duration = 6.6 ms
2016-11-22 01:28:39,571 _validate: [1769] First validation sample, perplexity 633.27.
2016-11-22 01:29:06,624 _validate: [1773] Center of validation, perplexity 628.27.
2016-11-22 01:29:40,397 _validate: [1778] Last validation sample, perplexity 765.22.
2016-11-22 01:29:40,413 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 01:29:40,413 _log_validation: [1778] Validation set cost history: 1850.8 917.7 [679.5]
2016-11-22 01:29:40,414 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 3.1 minutes. Best validation perplexity 679.53.
2016-11-22 01:29:44,820 _log_update: [66] (3.7 %) of epoch 4 -- lr = 5, cost = 6.21, duration = 6.6 ms
2016-11-22 01:29:58,141 _log_update: [266] (15.0 %) of epoch 4 -- lr = 5, cost = 2.57, duration = 6.6 ms
2016-11-22 01:30:11,470 _log_update: [466] (26.2 %) of epoch 4 -- lr = 5, cost = 2.76, duration = 6.6 ms
2016-11-22 01:30:24,791 _log_update: [666] (37.5 %) of epoch 4 -- lr = 5, cost = 3.83, duration = 6.6 ms
2016-11-22 01:30:38,112 _log_update: [866] (48.7 %) of epoch 4 -- lr = 5, cost = 2.44, duration = 6.6 ms
2016-11-22 01:30:51,434 _log_update: [1066] (60.0 %) of epoch 4 -- lr = 5, cost = 6.20, duration = 6.6 ms
2016-11-22 01:31:04,789 _log_update: [1266] (71.2 %) of epoch 4 -- lr = 5, cost = 2.70, duration = 6.6 ms
2016-11-22 01:31:18,113 _log_update: [1466] (82.5 %) of epoch 4 -- lr = 5, cost = 2.67, duration = 6.6 ms
2016-11-22 01:31:31,437 _log_update: [1666] (93.7 %) of epoch 4 -- lr = 5, cost = 2.91, duration = 6.6 ms
2016-11-22 01:31:44,974 _validate: [1769] First validation sample, perplexity 1762.80.
2016-11-22 01:32:11,993 _validate: [1773] Center of validation, perplexity 1313.36.
2016-11-22 01:32:45,842 _validate: [1778] Last validation sample, perplexity 1220.82.
2016-11-22 01:32:45,842 _log_validation: [1778] Validation set cost history: 1850.8 917.7 [679.5] 1361.1
2016-11-22 01:32:45,844 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 01:32:45,844 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 01:32:45,845 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 01:32:45,845 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 01:32:45,848 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 01:32:45,849 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 01:32:45,850 _reset_state: [1773] (99.72 %) of epoch 3
2016-11-22 01:32:45,850 _log_validation: [1773] Validation set cost history: 1850.8 917.7 [679.5]
2016-11-22 01:32:45,850 set_state: Restored iterator to line 41952 of 42068.
2016-11-22 01:32:45,851 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 01:32:45,854 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 01:32:45,855 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 01:32:45,855 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 01:32:45,856 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-22 01:32:45,857 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 3.
2016-11-22 01:32:45,858 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 3.1 minutes. Best validation perplexity 679.53.
2016-11-22 01:32:51,734 _log_update: [88] (4.9 %) of epoch 4 -- lr = 2, cost = 3.31, duration = 6.6 ms
2016-11-22 01:33:05,055 _log_update: [288] (16.2 %) of epoch 4 -- lr = 2, cost = 2.63, duration = 6.6 ms
2016-11-22 01:33:18,380 _log_update: [488] (27.4 %) of epoch 4 -- lr = 2, cost = 2.50, duration = 6.6 ms
2016-11-22 01:33:31,701 _log_update: [688] (38.7 %) of epoch 4 -- lr = 2, cost = 4.06, duration = 6.6 ms
2016-11-22 01:33:45,021 _log_update: [888] (49.9 %) of epoch 4 -- lr = 2, cost = 3.56, duration = 6.6 ms
2016-11-22 01:33:58,349 _log_update: [1088] (61.2 %) of epoch 4 -- lr = 2, cost = 2.50, duration = 6.6 ms
2016-11-22 01:34:11,735 _log_update: [1288] (72.4 %) of epoch 4 -- lr = 2, cost = 3.08, duration = 6.6 ms
2016-11-22 01:34:25,115 _log_update: [1488] (83.7 %) of epoch 4 -- lr = 2, cost = 2.96, duration = 6.6 ms
2016-11-22 01:34:38,482 _log_update: [1688] (94.9 %) of epoch 4 -- lr = 2, cost = 2.77, duration = 6.6 ms
2016-11-22 01:34:50,593 _validate: [1769] First validation sample, perplexity 530.54.
2016-11-22 01:35:17,671 _validate: [1773] Center of validation, perplexity 531.75.
2016-11-22 01:35:51,482 _validate: [1778] Last validation sample, perplexity 541.91.
2016-11-22 01:35:51,497 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 01:35:51,497 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 [532.0]
2016-11-22 01:35:51,498 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 3.1 minutes. Best validation perplexity 531.98.
2016-11-22 01:35:58,854 _log_update: [110] (6.2 %) of epoch 5 -- lr = 2, cost = 2.70, duration = 6.6 ms
2016-11-22 01:36:12,189 _log_update: [310] (17.4 %) of epoch 5 -- lr = 2, cost = 2.79, duration = 6.6 ms
2016-11-22 01:36:25,512 _log_update: [510] (28.7 %) of epoch 5 -- lr = 2, cost = 2.59, duration = 6.6 ms
2016-11-22 01:36:38,836 _log_update: [710] (39.9 %) of epoch 5 -- lr = 2, cost = 2.66, duration = 6.6 ms
2016-11-22 01:36:52,155 _log_update: [910] (51.2 %) of epoch 5 -- lr = 2, cost = 2.37, duration = 6.6 ms
2016-11-22 01:37:05,486 _log_update: [1110] (62.4 %) of epoch 5 -- lr = 2, cost = 4.66, duration = 6.6 ms
2016-11-22 01:37:18,812 _log_update: [1310] (73.7 %) of epoch 5 -- lr = 2, cost = 2.21, duration = 6.6 ms
2016-11-22 01:37:32,137 _log_update: [1510] (84.9 %) of epoch 5 -- lr = 2, cost = 2.29, duration = 6.6 ms
2016-11-22 01:37:45,456 _log_update: [1710] (96.2 %) of epoch 5 -- lr = 2, cost = 2.47, duration = 6.6 ms
2016-11-22 01:37:56,041 _validate: [1769] First validation sample, perplexity 477.80.
2016-11-22 01:38:23,014 _validate: [1773] Center of validation, perplexity 504.74.
2016-11-22 01:38:56,744 _validate: [1778] Last validation sample, perplexity 469.99.
2016-11-22 01:38:56,759 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 01:38:56,759 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 [490.4]
2016-11-22 01:38:56,760 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 3.1 minutes. Best validation perplexity 490.40.
2016-11-22 01:39:05,574 _log_update: [132] (7.4 %) of epoch 6 -- lr = 2, cost = 2.44, duration = 6.6 ms
2016-11-22 01:39:18,888 _log_update: [332] (18.7 %) of epoch 6 -- lr = 2, cost = 2.57, duration = 6.6 ms
2016-11-22 01:39:32,214 _log_update: [532] (29.9 %) of epoch 6 -- lr = 2, cost = 2.89, duration = 6.6 ms
2016-11-22 01:39:45,535 _log_update: [732] (41.2 %) of epoch 6 -- lr = 2, cost = 2.52, duration = 6.6 ms
2016-11-22 01:39:58,851 _log_update: [932] (52.4 %) of epoch 6 -- lr = 2, cost = 2.55, duration = 6.6 ms
2016-11-22 01:40:12,179 _log_update: [1132] (63.7 %) of epoch 6 -- lr = 2, cost = 2.37, duration = 6.6 ms
2016-11-22 01:40:25,504 _log_update: [1332] (74.9 %) of epoch 6 -- lr = 2, cost = 2.22, duration = 6.6 ms
2016-11-22 01:40:38,822 _log_update: [1532] (86.2 %) of epoch 6 -- lr = 2, cost = 2.35, duration = 6.6 ms
2016-11-22 01:40:52,143 _log_update: [1732] (97.4 %) of epoch 6 -- lr = 2, cost = 2.80, duration = 6.6 ms
2016-11-22 01:41:01,322 _validate: [1769] First validation sample, perplexity 480.96.
2016-11-22 01:41:28,300 _validate: [1773] Center of validation, perplexity 488.02.
2016-11-22 01:42:02,044 _validate: [1778] Last validation sample, perplexity 483.16.
2016-11-22 01:42:02,059 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 01:42:02,059 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 [489.6]
2016-11-22 01:42:02,060 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 3.1 minutes. Best validation perplexity 489.56.
2016-11-22 01:42:12,341 _log_update: [154] (8.7 %) of epoch 7 -- lr = 2, cost = 2.39, duration = 6.6 ms
2016-11-22 01:42:25,676 _log_update: [354] (19.9 %) of epoch 7 -- lr = 2, cost = 3.23, duration = 6.6 ms
2016-11-22 01:42:38,992 _log_update: [554] (31.2 %) of epoch 7 -- lr = 2, cost = 2.37, duration = 6.6 ms
2016-11-22 01:42:52,321 _log_update: [754] (42.4 %) of epoch 7 -- lr = 2, cost = 2.47, duration = 6.6 ms
2016-11-22 01:43:05,653 _log_update: [954] (53.7 %) of epoch 7 -- lr = 2, cost = 2.58, duration = 6.6 ms
2016-11-22 01:43:18,990 _log_update: [1154] (64.9 %) of epoch 7 -- lr = 2, cost = 2.34, duration = 6.6 ms
2016-11-22 01:43:32,312 _log_update: [1354] (76.2 %) of epoch 7 -- lr = 2, cost = 2.79, duration = 6.6 ms
2016-11-22 01:43:45,644 _log_update: [1554] (87.4 %) of epoch 7 -- lr = 2, cost = 3.21, duration = 6.6 ms
2016-11-22 01:43:58,964 _log_update: [1754] (98.7 %) of epoch 7 -- lr = 2, cost = 2.59, duration = 6.6 ms
2016-11-22 01:44:06,664 _validate: [1769] First validation sample, perplexity 417.35.
2016-11-22 01:44:33,755 _validate: [1773] Center of validation, perplexity 393.68.
2016-11-22 01:45:07,781 _validate: [1778] Last validation sample, perplexity 391.58.
2016-11-22 01:45:07,796 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 01:45:07,797 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 [400.1]
2016-11-22 01:45:07,798 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 3.1 minutes. Best validation perplexity 400.13.
2016-11-22 01:45:19,753 _log_update: [176] (9.9 %) of epoch 8 -- lr = 2, cost = 2.59, duration = 6.6 ms
2016-11-22 01:45:33,084 _log_update: [376] (21.1 %) of epoch 8 -- lr = 2, cost = 2.56, duration = 6.6 ms
2016-11-22 01:45:46,421 _log_update: [576] (32.4 %) of epoch 8 -- lr = 2, cost = 2.34, duration = 6.7 ms
2016-11-22 01:45:59,758 _log_update: [776] (43.6 %) of epoch 8 -- lr = 2, cost = 2.25, duration = 6.6 ms
2016-11-22 01:46:13,107 _log_update: [976] (54.9 %) of epoch 8 -- lr = 2, cost = 2.54, duration = 6.6 ms
2016-11-22 01:46:26,420 _log_update: [1176] (66.1 %) of epoch 8 -- lr = 2, cost = 2.40, duration = 6.6 ms
2016-11-22 01:46:39,744 _log_update: [1376] (77.4 %) of epoch 8 -- lr = 2, cost = 2.57, duration = 6.6 ms
2016-11-22 01:46:53,082 _log_update: [1576] (88.6 %) of epoch 8 -- lr = 2, cost = 2.35, duration = 6.6 ms
2016-11-22 01:47:12,666 _validate: [1769] First validation sample, perplexity 413.64.
2016-11-22 01:47:39,769 _validate: [1773] Center of validation, perplexity 494.70.
2016-11-22 01:47:53,429 _log_update: [1776] (99.9 %) of epoch 8 -- lr = 2, cost = 2.89, duration = 6.7 ms
2016-11-22 01:48:13,690 _validate: [1778] Last validation sample, perplexity 487.92.
2016-11-22 01:48:13,690 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 [400.1] 461.3
2016-11-22 01:48:13,691 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 01:48:13,692 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 01:48:13,692 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 01:48:13,692 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 01:48:13,695 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 01:48:13,696 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 01:48:13,697 _reset_state: [1773] (99.72 %) of epoch 7
2016-11-22 01:48:13,697 _log_validation: [1773] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 [400.1]
2016-11-22 01:48:13,698 set_state: Restored iterator to line 41956 of 42068.
2016-11-22 01:48:13,698 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 01:48:13,701 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 01:48:13,702 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 01:48:13,702 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 01:48:13,704 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-22 01:48:13,704 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 7.
2016-11-22 01:48:13,705 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 3.1 minutes. Best validation perplexity 400.13.
2016-11-22 01:48:26,934 _log_update: [198] (11.1 %) of epoch 8 -- lr = 1, cost = 2.18, duration = 6.6 ms
2016-11-22 01:48:40,260 _log_update: [398] (22.4 %) of epoch 8 -- lr = 1, cost = 2.54, duration = 6.6 ms
2016-11-22 01:48:53,596 _log_update: [598] (33.6 %) of epoch 8 -- lr = 1, cost = 3.37, duration = 6.6 ms
2016-11-22 01:49:06,940 _log_update: [798] (44.9 %) of epoch 8 -- lr = 1, cost = 2.51, duration = 6.6 ms
2016-11-22 01:49:20,271 _log_update: [998] (56.1 %) of epoch 8 -- lr = 1, cost = 2.60, duration = 6.6 ms
2016-11-22 01:49:33,599 _log_update: [1198] (67.4 %) of epoch 8 -- lr = 1, cost = 2.32, duration = 6.6 ms
2016-11-22 01:49:46,931 _log_update: [1398] (78.6 %) of epoch 8 -- lr = 1, cost = 2.38, duration = 6.6 ms
2016-11-22 01:50:00,260 _log_update: [1598] (89.9 %) of epoch 8 -- lr = 1, cost = 2.37, duration = 6.6 ms
2016-11-22 01:50:18,359 _validate: [1769] First validation sample, perplexity 306.43.
2016-11-22 01:50:45,444 _validate: [1773] Center of validation, perplexity 303.73.
2016-11-22 01:51:19,279 _validate: [1778] Last validation sample, perplexity 299.99.
2016-11-22 01:51:19,295 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 01:51:19,295 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 [303.0]
2016-11-22 01:51:19,296 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 3.1 minutes. Best validation perplexity 302.95.
2016-11-22 01:51:20,645 _log_update: [20] (1.1 %) of epoch 9 -- lr = 1, cost = 3.31, duration = 6.6 ms
2016-11-22 01:51:33,985 _log_update: [220] (12.4 %) of epoch 9 -- lr = 1, cost = 2.41, duration = 6.6 ms
2016-11-22 01:51:47,316 _log_update: [420] (23.6 %) of epoch 9 -- lr = 1, cost = 2.35, duration = 6.7 ms
2016-11-22 01:52:00,659 _log_update: [620] (34.9 %) of epoch 9 -- lr = 1, cost = 3.79, duration = 6.6 ms
2016-11-22 01:52:14,002 _log_update: [820] (46.1 %) of epoch 9 -- lr = 1, cost = 2.56, duration = 6.6 ms
2016-11-22 01:52:27,345 _log_update: [1020] (57.4 %) of epoch 9 -- lr = 1, cost = 2.47, duration = 6.6 ms
2016-11-22 01:52:40,681 _log_update: [1220] (68.6 %) of epoch 9 -- lr = 1, cost = 2.66, duration = 6.6 ms
2016-11-22 01:52:54,020 _log_update: [1420] (79.9 %) of epoch 9 -- lr = 1, cost = 2.23, duration = 6.7 ms
2016-11-22 01:53:07,354 _log_update: [1620] (91.1 %) of epoch 9 -- lr = 1, cost = 4.09, duration = 6.6 ms
2016-11-22 01:53:23,971 _validate: [1769] First validation sample, perplexity 327.62.
2016-11-22 01:53:50,971 _validate: [1773] Center of validation, perplexity 319.86.
2016-11-22 01:54:24,807 _validate: [1778] Last validation sample, perplexity 320.91.
2016-11-22 01:54:24,807 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 [303.0] 321.1
2016-11-22 01:54:24,809 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 01:54:24,809 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 01:54:24,810 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 01:54:24,810 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 01:54:24,813 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 01:54:24,814 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 01:54:24,815 _reset_state: [1773] (99.72 %) of epoch 8
2016-11-22 01:54:24,815 _log_validation: [1773] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 [303.0]
2016-11-22 01:54:24,816 set_state: Restored iterator to line 41955 of 42068.
2016-11-22 01:54:24,816 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 01:54:24,819 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 01:54:24,820 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 01:54:24,820 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 01:54:24,822 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-22 01:54:24,822 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 8.
2016-11-22 01:54:24,823 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 3.1 minutes. Best validation perplexity 302.95.
2016-11-22 01:54:27,631 _log_update: [42] (2.4 %) of epoch 9 -- lr = 0.6, cost = 2.56, duration = 6.6 ms
2016-11-22 01:54:40,957 _log_update: [242] (13.6 %) of epoch 9 -- lr = 0.6, cost = 3.04, duration = 6.6 ms
2016-11-22 01:54:54,274 _log_update: [442] (24.9 %) of epoch 9 -- lr = 0.6, cost = 2.38, duration = 6.6 ms
2016-11-22 01:55:07,612 _log_update: [642] (36.1 %) of epoch 9 -- lr = 0.6, cost = 2.47, duration = 6.6 ms
2016-11-22 01:55:20,955 _log_update: [842] (47.4 %) of epoch 9 -- lr = 0.6, cost = 2.18, duration = 6.6 ms
2016-11-22 01:55:34,282 _log_update: [1042] (58.6 %) of epoch 9 -- lr = 0.6, cost = 2.29, duration = 6.6 ms
2016-11-22 01:55:47,614 _log_update: [1242] (69.9 %) of epoch 9 -- lr = 0.6, cost = 2.11, duration = 6.6 ms
2016-11-22 01:56:00,966 _log_update: [1442] (81.1 %) of epoch 9 -- lr = 0.6, cost = 2.29, duration = 6.7 ms
2016-11-22 01:56:14,306 _log_update: [1642] (92.4 %) of epoch 9 -- lr = 0.6, cost = 2.27, duration = 6.6 ms
2016-11-22 01:56:29,447 _validate: [1769] First validation sample, perplexity 267.44.
2016-11-22 01:56:56,449 _validate: [1773] Center of validation, perplexity 269.17.
2016-11-22 01:57:30,324 _validate: [1778] Last validation sample, perplexity 269.86.
2016-11-22 01:57:30,339 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 01:57:30,340 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 303.0 [268.5]
2016-11-22 01:57:30,341 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 3.1 minutes. Best validation perplexity 268.52.
2016-11-22 01:57:34,613 _log_update: [64] (3.6 %) of epoch 10 -- lr = 0.6, cost = 2.52, duration = 6.6 ms
2016-11-22 01:57:47,926 _log_update: [264] (14.8 %) of epoch 10 -- lr = 0.6, cost = 2.35, duration = 6.6 ms
2016-11-22 01:58:01,245 _log_update: [464] (26.1 %) of epoch 10 -- lr = 0.6, cost = 3.47, duration = 6.6 ms
2016-11-22 01:58:14,562 _log_update: [664] (37.3 %) of epoch 10 -- lr = 0.6, cost = 2.94, duration = 6.6 ms
2016-11-22 01:58:27,886 _log_update: [864] (48.6 %) of epoch 10 -- lr = 0.6, cost = 3.52, duration = 6.6 ms
2016-11-22 01:58:41,202 _log_update: [1064] (59.8 %) of epoch 10 -- lr = 0.6, cost = 2.34, duration = 6.6 ms
2016-11-22 01:58:54,530 _log_update: [1264] (71.1 %) of epoch 10 -- lr = 0.6, cost = 2.49, duration = 6.7 ms
2016-11-22 01:59:07,862 _log_update: [1464] (82.3 %) of epoch 10 -- lr = 0.6, cost = 2.80, duration = 6.6 ms
2016-11-22 01:59:21,181 _log_update: [1664] (93.6 %) of epoch 10 -- lr = 0.6, cost = 1.97, duration = 6.5 ms
2016-11-22 01:59:34,879 _validate: [1769] First validation sample, perplexity 249.47.
2016-11-22 02:00:01,949 _validate: [1773] Center of validation, perplexity 251.77.
2016-11-22 02:00:35,810 _validate: [1778] Last validation sample, perplexity 252.27.
2016-11-22 02:00:35,825 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 02:00:35,825 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 303.0 268.5 [251.5]
2016-11-22 02:00:35,826 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 3.1 minutes. Best validation perplexity 251.47.
2016-11-22 02:00:41,568 _log_update: [86] (4.8 %) of epoch 11 -- lr = 0.6, cost = 2.13, duration = 6.6 ms
2016-11-22 02:00:54,921 _log_update: [286] (16.1 %) of epoch 11 -- lr = 0.6, cost = 2.70, duration = 6.9 ms
2016-11-22 02:01:08,275 _log_update: [486] (27.3 %) of epoch 11 -- lr = 0.6, cost = 3.59, duration = 6.6 ms
2016-11-22 02:01:21,612 _log_update: [686] (38.6 %) of epoch 11 -- lr = 0.6, cost = 2.20, duration = 6.6 ms
2016-11-22 02:01:34,952 _log_update: [886] (49.8 %) of epoch 11 -- lr = 0.6, cost = 2.40, duration = 6.6 ms
2016-11-22 02:01:48,280 _log_update: [1086] (61.1 %) of epoch 11 -- lr = 0.6, cost = 2.36, duration = 6.6 ms
2016-11-22 02:02:01,628 _log_update: [1286] (72.3 %) of epoch 11 -- lr = 0.6, cost = 2.39, duration = 6.7 ms
2016-11-22 02:02:14,961 _log_update: [1486] (83.6 %) of epoch 11 -- lr = 0.6, cost = 2.42, duration = 6.6 ms
2016-11-22 02:02:28,284 _log_update: [1686] (94.8 %) of epoch 11 -- lr = 0.6, cost = 2.72, duration = 6.6 ms
2016-11-22 02:02:40,535 _validate: [1769] First validation sample, perplexity 240.73.
2016-11-22 02:03:07,631 _validate: [1773] Center of validation, perplexity 241.10.
2016-11-22 02:03:41,407 _validate: [1778] Last validation sample, perplexity 240.61.
2016-11-22 02:03:41,422 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 02:03:41,422 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 303.0 268.5 251.5 [240.6]
2016-11-22 02:03:41,423 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 3.1 minutes. Best validation perplexity 240.59.
2016-11-22 02:03:48,639 _log_update: [108] (6.1 %) of epoch 12 -- lr = 0.6, cost = 2.34, duration = 6.7 ms
2016-11-22 02:04:01,974 _log_update: [308] (17.3 %) of epoch 12 -- lr = 0.6, cost = 2.41, duration = 6.6 ms
2016-11-22 02:04:15,314 _log_update: [508] (28.6 %) of epoch 12 -- lr = 0.6, cost = 2.20, duration = 6.6 ms
2016-11-22 02:04:28,651 _log_update: [708] (39.8 %) of epoch 12 -- lr = 0.6, cost = 2.12, duration = 6.6 ms
2016-11-22 02:04:41,981 _log_update: [908] (51.1 %) of epoch 12 -- lr = 0.6, cost = 2.29, duration = 6.6 ms
2016-11-22 02:04:55,316 _log_update: [1108] (62.3 %) of epoch 12 -- lr = 0.6, cost = 2.95, duration = 6.6 ms
2016-11-22 02:05:08,657 _log_update: [1308] (73.6 %) of epoch 12 -- lr = 0.6, cost = 2.20, duration = 6.7 ms
2016-11-22 02:05:21,980 _log_update: [1508] (84.8 %) of epoch 12 -- lr = 0.6, cost = 2.60, duration = 6.6 ms
2016-11-22 02:05:35,292 _log_update: [1708] (96.1 %) of epoch 12 -- lr = 0.6, cost = 2.72, duration = 6.6 ms
2016-11-22 02:05:46,013 _validate: [1769] First validation sample, perplexity 269.55.
2016-11-22 02:06:13,031 _validate: [1773] Center of validation, perplexity 269.29.
2016-11-22 02:06:46,885 _validate: [1778] Last validation sample, perplexity 270.16.
2016-11-22 02:06:46,885 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 303.0 268.5 251.5 [240.6] 269.3
2016-11-22 02:06:46,887 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 02:06:46,887 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 02:06:46,888 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 02:06:46,888 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 02:06:46,891 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 02:06:46,892 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 02:06:46,893 _reset_state: [1773] (99.72 %) of epoch 11
2016-11-22 02:06:46,893 _log_validation: [1773] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 303.0 268.5 251.5 [240.6]
2016-11-22 02:06:46,893 set_state: Restored iterator to line 41952 of 42068.
2016-11-22 02:06:46,894 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 02:06:46,897 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 02:06:46,897 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 02:06:46,898 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 02:06:46,899 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-22 02:06:46,900 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 11.
2016-11-22 02:06:46,901 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 3.1 minutes. Best validation perplexity 240.59.
2016-11-22 02:06:55,580 _log_update: [130] (7.3 %) of epoch 12 -- lr = 0.3, cost = 2.32, duration = 6.6 ms
2016-11-22 02:07:08,907 _log_update: [330] (18.6 %) of epoch 12 -- lr = 0.3, cost = 2.59, duration = 6.6 ms
2016-11-22 02:07:22,229 _log_update: [530] (29.8 %) of epoch 12 -- lr = 0.3, cost = 1.98, duration = 6.6 ms
2016-11-22 02:07:35,556 _log_update: [730] (41.1 %) of epoch 12 -- lr = 0.3, cost = 2.22, duration = 6.6 ms
2016-11-22 02:07:48,884 _log_update: [930] (52.3 %) of epoch 12 -- lr = 0.3, cost = 2.22, duration = 6.6 ms
2016-11-22 02:08:02,233 _log_update: [1130] (63.6 %) of epoch 12 -- lr = 0.3, cost = 2.42, duration = 6.6 ms
2016-11-22 02:08:15,594 _log_update: [1330] (74.8 %) of epoch 12 -- lr = 0.3, cost = 2.16, duration = 6.6 ms
2016-11-22 02:08:28,964 _log_update: [1530] (86.1 %) of epoch 12 -- lr = 0.3, cost = 2.15, duration = 6.6 ms
2016-11-22 02:08:42,326 _log_update: [1730] (97.3 %) of epoch 12 -- lr = 0.3, cost = 2.51, duration = 6.6 ms
2016-11-22 02:08:51,630 _validate: [1769] First validation sample, perplexity 225.62.
2016-11-22 02:09:18,692 _validate: [1773] Center of validation, perplexity 228.07.
2016-11-22 02:09:52,542 _validate: [1778] Last validation sample, perplexity 227.65.
2016-11-22 02:09:52,557 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 02:09:52,557 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 303.0 268.5 251.5 240.6 [227.2]
2016-11-22 02:09:52,558 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 3.1 minutes. Best validation perplexity 227.24.
2016-11-22 02:10:02,701 _log_update: [152] (8.5 %) of epoch 13 -- lr = 0.3, cost = 2.31, duration = 6.6 ms
2016-11-22 02:10:16,026 _log_update: [352] (19.8 %) of epoch 13 -- lr = 0.3, cost = 2.30, duration = 6.6 ms
2016-11-22 02:10:29,347 _log_update: [552] (31.0 %) of epoch 13 -- lr = 0.3, cost = 2.68, duration = 6.6 ms
2016-11-22 02:10:42,673 _log_update: [752] (42.3 %) of epoch 13 -- lr = 0.3, cost = 2.59, duration = 6.7 ms
2016-11-22 02:10:56,014 _log_update: [952] (53.5 %) of epoch 13 -- lr = 0.3, cost = 2.41, duration = 6.6 ms
2016-11-22 02:11:09,348 _log_update: [1152] (64.8 %) of epoch 13 -- lr = 0.3, cost = 2.32, duration = 6.6 ms
2016-11-22 02:11:22,673 _log_update: [1352] (76.0 %) of epoch 13 -- lr = 0.3, cost = 2.31, duration = 6.6 ms
2016-11-22 02:11:36,004 _log_update: [1552] (87.3 %) of epoch 13 -- lr = 0.3, cost = 2.30, duration = 6.6 ms
2016-11-22 02:11:49,331 _log_update: [1752] (98.5 %) of epoch 13 -- lr = 0.3, cost = 2.39, duration = 6.6 ms
2016-11-22 02:11:57,153 _validate: [1769] First validation sample, perplexity 223.96.
2016-11-22 02:12:24,139 _validate: [1773] Center of validation, perplexity 224.39.
2016-11-22 02:12:57,956 _validate: [1778] Last validation sample, perplexity 224.83.
2016-11-22 02:12:57,971 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 02:12:57,972 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 303.0 268.5 251.5 240.6 227.2 [224.4]
2016-11-22 02:12:57,973 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 3.1 minutes. Best validation perplexity 224.44.
2016-11-22 02:13:09,581 _log_update: [174] (9.8 %) of epoch 14 -- lr = 0.3, cost = 2.47, duration = 6.6 ms
2016-11-22 02:13:22,908 _log_update: [374] (21.0 %) of epoch 14 -- lr = 0.3, cost = 2.17, duration = 6.6 ms
2016-11-22 02:13:36,227 _log_update: [574] (32.3 %) of epoch 14 -- lr = 0.3, cost = 2.47, duration = 6.6 ms
2016-11-22 02:13:49,547 _log_update: [774] (43.5 %) of epoch 14 -- lr = 0.3, cost = 2.19, duration = 6.6 ms
2016-11-22 02:14:02,883 _log_update: [974] (54.8 %) of epoch 14 -- lr = 0.3, cost = 2.43, duration = 6.6 ms
2016-11-22 02:14:16,211 _log_update: [1174] (66.0 %) of epoch 14 -- lr = 0.3, cost = 2.20, duration = 6.6 ms
2016-11-22 02:14:29,533 _log_update: [1374] (77.3 %) of epoch 14 -- lr = 0.3, cost = 2.54, duration = 6.6 ms
2016-11-22 02:14:42,855 _log_update: [1574] (88.5 %) of epoch 14 -- lr = 0.3, cost = 2.10, duration = 6.6 ms
2016-11-22 02:15:02,530 _validate: [1769] First validation sample, perplexity 223.90.
2016-11-22 02:15:29,606 _validate: [1773] Center of validation, perplexity 223.32.
2016-11-22 02:15:29,709 _log_update: [1774] (99.8 %) of epoch 14 -- lr = 0.3, cost = 2.35, duration = 6.7 ms
2016-11-22 02:16:03,416 _validate: [1778] Last validation sample, perplexity 223.98.
2016-11-22 02:16:03,431 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 02:16:03,431 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 303.0 268.5 251.5 240.6 227.2 224.4 [223.4]
2016-11-22 02:16:03,432 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 3.1 minutes. Best validation perplexity 223.40.
2016-11-22 02:16:16,503 _log_update: [196] (11.0 %) of epoch 15 -- lr = 0.3, cost = 2.23, duration = 6.6 ms
2016-11-22 02:16:29,828 _log_update: [396] (22.3 %) of epoch 15 -- lr = 0.3, cost = 2.43, duration = 6.6 ms
2016-11-22 02:16:43,158 _log_update: [596] (33.5 %) of epoch 15 -- lr = 0.3, cost = 2.30, duration = 6.6 ms
2016-11-22 02:16:56,501 _log_update: [796] (44.8 %) of epoch 15 -- lr = 0.3, cost = 2.15, duration = 6.6 ms
2016-11-22 02:17:09,846 _log_update: [996] (56.0 %) of epoch 15 -- lr = 0.3, cost = 2.79, duration = 6.6 ms
2016-11-22 02:17:23,175 _log_update: [1196] (67.3 %) of epoch 15 -- lr = 0.3, cost = 1.94, duration = 6.6 ms
2016-11-22 02:17:36,498 _log_update: [1396] (78.5 %) of epoch 15 -- lr = 0.3, cost = 1.86, duration = 6.6 ms
2016-11-22 02:17:49,827 _log_update: [1596] (89.8 %) of epoch 15 -- lr = 0.3, cost = 2.30, duration = 6.6 ms
2016-11-22 02:18:08,027 _validate: [1769] First validation sample, perplexity 217.74.
2016-11-22 02:18:35,005 _validate: [1773] Center of validation, perplexity 218.33.
2016-11-22 02:19:08,839 _validate: [1778] Last validation sample, perplexity 219.29.
2016-11-22 02:19:08,854 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 02:19:08,854 _log_validation: [1778] Validation set cost history: 1850.8 917.7 679.5 532.0 490.4 489.6 400.1 303.0 268.5 251.5 240.6 227.2 224.4 223.4 [218.2]
2016-11-22 02:19:08,855 _reset: Generating a random order of input lines.
Finished training epoch 15 in 0 hours 3.1 minutes. Best validation perplexity 218.17.
Stopping because 15 epochs was reached.
Training finished in 0 hours 58.8 minutes.
2016-11-22 02:19:08,864 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 02:19:08,864 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 02:19:08,864 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 02:19:08,865 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 02:19:08,868 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 02:19:08,869 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
Best validation set perplexity: 218.331002508
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Scoring text.
Number of sentences: 3761
Number of words: 86191
Number of predicted probabilities: 82430
Cross entropy (base e): 5.341982079945027
Perplexity: 208.92640900697012
